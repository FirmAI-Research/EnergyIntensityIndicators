"""
[summary]
"""
import pandas as pd
import os

def get_ahs():
    """Extract and process American Housing Survey (AHS, formerly Annual Housing Survey)
    """    
    # 2017_AHS_flat = pd.read_csv('./')
    # columns = ['JYRBUILT', 'WEIGHT', 'YRBUILT', 'DIVISION', 'BLD', 'UNITSIZE', 'VACANCY']
    # extract_ahs = 2017_AHS_flat[columns]
    # housing_types = ['single_family', 'multifamily', 'manufactured_homes']
    # housing_occupancy_types = [f'{h}_total' for h in housing_types] + [f'{h}_occupied' for h in housing_types]

    # Pivot Tables!!
    #  Rows correspond to various size categories columns correspond to census division which are then aggregated to census regions. 
    #  Only Categorical size data were included in the AHS surveys for 2015 and 2017. An effort to 
    # utilize the category data to estimate the average size change between 2015 and 2017 did not provide useful results. Processing of future AHS public use
    # files may exlcude any consideration of this variable. In the current tables, only the values for total units across all sizes were considered.
    pass

def get_seds():
    """[summary]
    
    """    
    years = list(range(1960, 2018))
    years = [str(year) for year in years]
    consumption_all_btu = pd.read_csv('../use_all_btu.csv') # 1960 through 2017 SEDS Data, MSN refers to fuel type
    state_to_census_region = pd.read_csv('./state_to_census_region.csv')
    consumption_census_region = consumption_all_btu.merge(state_to_census_region, left_on='State', right_on='USPC', how='left')
    # print(consumption_all_btu.head())
    
    pivotted = pd.pivot_table(consumption_census_region, index=years, columns='MSN', aggfunc='sum')  # , values='Census Region'
    pivotted['Grand Total'] = pivotted.sum()
    pivotted = pivotted[['ESRCB', 'TNRCB']]
    print(pivotted)

    pivotted_by_census_region = pd.pivot_table(consumption_census_region, index=years, columns='MSN', aggfunc='sum')
    # print('pivotted_by_census_region', pivotted_by_census_region.head())
    esccb_by_census_region = pivotted_by_census_region.reset_index()
    # print('esccb_by_census_region', esccb_by_census_region)
    tnccb_by_census_region = pivotted_by_census_region.reset_index()
    ESCCB_by_region = pd.pivot_table(pivotted_by_census_region['ESCCB'], index=years , columns='Census Region', aggfunc='sum')
    TNCCB_by_region = pd.pivot_table(pivotted_by_census_region['TNCCB'], index=years , columns='Census Region', aggfunc='sum')
    # PRINT(TNCCB_by_region)


print(f'current directory: {os.getcwd()}')
get_seds()
                       

