============================= test session starts =============================
platform win32 -- Python 3.6.5, pytest-5.4.3, py-1.8.0, pluggy-0.12.0
rootdir: C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators
collected 5 items

tests\lmdi_test.py .FF..                                                 [100%]

================================== FAILURES ===================================
_____________________ TestLMDI.test_calculate_log_changes _____________________

self = <lmdi_test.TestLMDI object at 0x000001D081D31F60>
sector = 'transportation'

    def test_calculate_log_changes(self, sector='transportation'):
        eii = self.eii_output_factory(sector)
    
        input_data = [[1.2759, 0.9869],
                      [1.2650, 0.9743],
                      [1.2579, 0.9910],
                      [1.2634, 0.9915],
                      [1.2396, 0.9906]]
    
    
        input_df = pd.DataFrame(input_data,
                                     index=[1970, 1971, 1972, 1973, 1974],
                                     columns=['All_Passenger', 'All_Freight'])
    
        log_ratio_df = eii.calculate_log_changes(input_df)
        log_ratio_df = log_ratio_df.round(4)
        comparison_output = [[np.nan, np.nan],
                             [-0.0086, -0.0129],
                             [-0.0056, 0.0170],
                             [0.0044, 0.0005],
                             [-0.0190, -0.0009]]
    
        comparison_df = pd.DataFrame(comparison_output,
                                     index=[1970, 1971, 1972, 1973, 1974],
                                     columns=['All_Passenger', 'All_Freight'])
        print('comparison_df:\n', comparison_df)
        print('log_ratio_df:\n', log_ratio_df)
>       assert log_ratio_df.equals(comparison_df)
E       assert False
E        +  where False = <bound method NDFrame.equals of       All_Passenger  All_Freight\n1970            NaN          NaN\n1971        -0.0086      -0.0128\n1972        -0.0056       0.0170\n1973         0.0044       0.0005\n1974        -0.0190      -0.0009>(      All_Passenger  All_Freight\n1970            NaN          NaN\n1971        -0.0086      -0.0129\n1972        -0.0056       0.0170\n1973         0.0044       0.0005\n1974        -0.0190      -0.0009)
E        +    where <bound method NDFrame.equals of       All_Passenger  All_Freight\n1970            NaN          NaN\n1971        -0.0086      -0.0128\n1972        -0.0056       0.0170\n1973         0.0044       0.0005\n1974        -0.0190      -0.0009> =       All_Passenger  All_Freight\n1970            NaN          NaN\n1971        -0.0086      -0.0128\n1972        -0.0056       0.0170\n1973         0.0044       0.0005\n1974        -0.0190      -0.0009.equals

tests\lmdi_test.py:315: AssertionError
---------------------------- Captured stdout call -----------------------------
comparison_df:
       All_Passenger  All_Freight
1970            NaN          NaN
1971        -0.0086      -0.0129
1972        -0.0056       0.0170
1973         0.0044       0.0005
1974        -0.0190      -0.0009
log_ratio_df:
       All_Passenger  All_Freight
1970            NaN          NaN
1971        -0.0086      -0.0128
1972        -0.0056       0.0170
1973         0.0044       0.0005
1974        -0.0190      -0.0009
_________________________ TestLMDI.test_compute_index _________________________

self = <lmdi_test.TestLMDI object at 0x000001D08DA98B38>

    def test_compute_index(self):
        eii = MultiplicativeLMDI()
    
        results = [[0.9705, 1.0386, 1.0037],
                   [0.9957, 1.0329, 1.0054],
                   [0.9982, 1.0145, 1.0052],
                   [1.0076, 1.0165, 1.0066],
                   [0.9814, 1.0412, 1.0016]]
    
        results = pd.DataFrame(results,
                               index=[1983, 1984, 1985, 1986, 1987],
                               columns=['Intensity Index', 'Activity Index', 'Structure Index'])
    
        for col in results.columns:
>           results[col] = eii.compute_index(results[col], 1985)

tests\lmdi_test.py:368: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <EnergyIntensityIndicators.multiplicative_lmdi.MultiplicativeLMDI object at 0x000001D08DA98080>
component = 1983    0.9705
1984    0.9957
1985    0.9982
1986    1.0076
1987    0.9814
Name: Intensity Index, dtype: float64
base_year_ = 1985

    def compute_index(self, component, base_year_):
        """
        """
        # component_shift = component.shift(periods=1, axis='index', fill_value=1)
        index = pd.DataFrame(index=component.index, columns=['index'])
        for y in component.index:
            if y > min(component.index):
                if component.loc[y] == np.nan:
                    index.loc[y, 'index'] = index.loc[y - 1, 'index']
                else:
>                   index.loc[y, 'index'] = component.loc[y].multiply(index.loc[y - 1, 'index'])
E                   AttributeError: 'numpy.float64' object has no attribute 'multiply'

EnergyIntensityIndicators\multiplicative_lmdi.py:79: AttributeError
=========================== short test summary info ===========================
FAILED tests/lmdi_test.py::TestLMDI::test_calculate_log_changes - assert False
FAILED tests/lmdi_test.py::TestLMDI::test_compute_index - AttributeError: 'nu...
=================== 2 failed, 3 passed in 128.35s (0:02:08) ===================
