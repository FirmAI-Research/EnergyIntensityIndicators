============================= test session starts =============================
platform win32 -- Python 3.6.5, pytest-5.4.3, py-1.8.0, pluggy-0.12.0
rootdir: C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators
collected 4 items

tests\lmdi_test.py .FFF                                                  [100%]

================================== FAILURES ===================================
_____________________________ TestLMDI.test_shift _____________________________

self = <lmdi_test.TestLMDI object at 0x0000018EA40BE400>
sector = 'transportation'

    def test_shift(self, sector='transportation'):
        eii = self.eii_output_factory(sector)
        pnnl_data = [[0.5433, 0.1449], [0.5479, 0.1402], [0.5650, 0.1367]]
        energy_shares = pd.DataFrame(pnnl_data, index=[1970, 1971, 1972], columns=['Highway', 'Rail'])
    
        log_mean_weights = pd.DataFrame(index=energy_shares.index)
        print("log_mean_divisia_weights energy shares:", energy_shares)
        for col in energy_shares.columns:
            print(f'log_mean_divisia_weights col: {col}')
            energy_shares[f"{col}_shift"] = energy_shares[col].shift(periods=1, axis='index', fill_value=0)
            print('energy shares with shift:\n', energy_shares)
            # apply generally not preferred for row-wise operations but?
            log_mean_weights[f'log_mean_weights_{col}'] = energy_shares.apply(lambda row: \
                                                          eii.logarithmic_average(row[col], row[f"{col}_shift"]), axis=1)
        print('log_mean_weights:\n', log_mean_weights)
        log_mean_weights = log_mean_weights.loc[1971:, :]
        print('log_mean_weights:\n', log_mean_weights)
        log_mean_weights = log_mean_weights.round(4)
        print('log_mean_weights:\n', log_mean_weights)
    
        pnnl_results = [[0.5456, 0.1425], [0.5564, 0.1385]]
        pnnl_df = pd.DataFrame(pnnl_results, index=[1971, 1972], columns=['log_mean_weights_Highway', 'log_mean_weights_Rail'])
        print('pnnl_df:\n', pnnl_df)
>       assert pnnl_df.equals(log_mean_weights)
E       assert False
E        +  where False = <bound method NDFrame.equals of       log_mean_weights_Highway  log_mean_weights_Rail\n1971                    0.5456                 0.1425\n1972                    0.5564                 0.1385>(      log_mean_weights_Highway  log_mean_weights_Rail\n1971                    0.5456                 0.1425\n1972                    0.5564                 0.1384)
E        +    where <bound method NDFrame.equals of       log_mean_weights_Highway  log_mean_weights_Rail\n1971                    0.5456                 0.1425\n1972                    0.5564                 0.1385> =       log_mean_weights_Highway  log_mean_weights_Rail\n1971                    0.5456                 0.1425\n1972                    0.5564                 0.1385.equals

tests\lmdi_test.py:316: AssertionError
---------------------------- Captured stdout call -----------------------------
log_mean_divisia_weights energy shares:       Highway    Rail
1970   0.5433  0.1449
1971   0.5479  0.1402
1972   0.5650  0.1367
log_mean_divisia_weights col: Highway
energy shares with shift:
       Highway    Rail  Highway_shift
1970   0.5433  0.1449         0.0000
1971   0.5479  0.1402         0.5433
1972   0.5650  0.1367         0.5479
log_mean_divisia_weights col: Rail
energy shares with shift:
       Highway    Rail  Highway_shift  Rail_shift
1970   0.5433  0.1449         0.0000      0.0000
1971   0.5479  0.1402         0.5433      0.1449
1972   0.5650  0.1367         0.5479      0.1402
log_mean_weights:
       log_mean_weights_Highway  log_mean_weights_Rail
1970                       NaN                    NaN
1971                  0.545597               0.142537
1972                  0.556406               0.138443
log_mean_weights:
       log_mean_weights_Highway  log_mean_weights_Rail
1971                  0.545597               0.142537
1972                  0.556406               0.138443
log_mean_weights:
       log_mean_weights_Highway  log_mean_weights_Rail
1971                    0.5456                 0.1425
1972                    0.5564                 0.1384
pnnl_df:
       log_mean_weights_Highway  log_mean_weights_Rail
1971                    0.5456                 0.1425
1972                    0.5564                 0.1385
_______________________ TestLMDI.test_normalize_weights _______________________

self = <lmdi_test.TestLMDI object at 0x0000018EB0D1E6D8>
sector = 'transportation'

    def test_normalize_weights(self, sector='transportation'):
        # eii = self.eii_output_factory(sector)
        pnnl_results = [[0.5456, 0.1425, 0.0436, 0.0556, 0.2126],
                        [0.5564, 0.1385, 0.0449, 0.0525, 0.2076]]
        log_mean_weights = pd.DataFrame(pnnl_results, index=[1971, 1972], columns=['log_mean_weights_Highway', 'log_mean_weights_Rail', 'log_mean_weights_Air', 'log_mean_weights_Waterborne', 'log_mean_weights_Pipeline'])
        sum_log_mean_shares = log_mean_weights.sum(axis=1)
        test_total = pd.Series([[0.9999], [0.9999]], index=[1971, 1972])
        print('sum_log_mean_shares:\n', sum_log_mean_shares)
        print('sum_log_mean_shares == test_total', sum_log_mean_shares.equals(test_total))
        log_mean_weights_normalized = log_mean_weights.divide(sum_log_mean_shares.values.reshape(len(sum_log_mean_shares), 1))
        log_mean_weights_normalized = log_mean_weights_normalized.round(4)
        print('log_mean_weights_normalized:\n', log_mean_weights_normalized)
    
        pnnl_normalized = [[0.5456, 0.1425, 0.0436, 0.0556, 0.2126],
                           [0.5565, 0.1385, 0.0449, 0.0525, 0.2076]]
        pnnl_normalized_df = pd.DataFrame(pnnl_normalized, index=[1971, 1972], columns=['log_mean_weights_Highway', 'log_mean_weights_Rail', 'log_mean_weights_Air', 'log_mean_weights_Waterborne', 'log_mean_weights_Pipeline'])
        print('pnnl_normalized_df:\n', pnnl_normalized_df)
>       assert log_mean_weights_normalized.equals(pnnl_normalized_df)
E       assert False
E        +  where False = <bound method NDFrame.equals of       log_mean_weights_Highway  ...  log_mean_weights_Pipeline\n1971                   ...7  ...                     0.2126\n1972                    0.5565  ...                     0.2076\n\n[2 rows x 5 columns]>(      log_mean_weights_Highway  ...  log_mean_weights_Pipeline\n1971                    0.5456  ...                     0.2126\n1972                    0.5565  ...                     0.2076\n\n[2 rows x 5 columns])
E        +    where <bound method NDFrame.equals of       log_mean_weights_Highway  ...  log_mean_weights_Pipeline\n1971                   ...7  ...                     0.2126\n1972                    0.5565  ...                     0.2076\n\n[2 rows x 5 columns]> =       log_mean_weights_Highway  ...  log_mean_weights_Pipeline\n1971                    0.5457  ...                     0.2126\n1972                    0.5565  ...                     0.2076\n\n[2 rows x 5 columns].equals

tests\lmdi_test.py:335: AssertionError
---------------------------- Captured stdout call -----------------------------
sum_log_mean_shares:
 1971    0.9999
1972    0.9999
dtype: float64
sum_log_mean_shares == test_total False
log_mean_weights_normalized:
       log_mean_weights_Highway  ...  log_mean_weights_Pipeline
1971                    0.5457  ...                     0.2126
1972                    0.5565  ...                     0.2076

[2 rows x 5 columns]
pnnl_normalized_df:
       log_mean_weights_Highway  ...  log_mean_weights_Pipeline
1971                    0.5456  ...                     0.2126
1972                    0.5565  ...                     0.2076

[2 rows x 5 columns]
_ TestLMDI.test_multiplicative_lmdi_log_mean_divisia_weights[transportation] __

self = <lmdi_test.TestLMDI object at 0x0000018EB0CDD9B0>
sector = 'transportation', acceptable_pct_difference = 0.05

    @pytest.mark.parametrize('sector', ['transportation']) # 'residential', 'commercial', 'industrial', 'electricity',
    def test_multiplicative_lmdi_log_mean_divisia_weights(self, sector, acceptable_pct_difference=0.05):
        """Multiplicative test should use original PNNL data (compiled for #13)
        Test should be parametrized to loop through all sectors.
        """
        eii = self.eii_output_factory(sector)
    
        pnnl_data = self.get_pnnl_input(sector, 'intermediate')
        eii_, pnnl_data_ = self.input_data(sector, level_of_aggregation_='All_Freight.Pipeline')
    
        bools_list = []
    
        for e_type in pnnl_data['Energy Type'].unique():
    
            for level_ in pnnl_data['Nest level'].unique():
                energy_data = pnnl_data_[e_type]['energy']
                energy_shares = pnnl_data[(pnnl_data['Data Type'] == 'Energy Shares') & (pnnl_data['Nest level'] == level_)]
                energy_shares = energy_shares[['Year', 'Category', 'Value']]
                energy_shares['Value'] = energy_shares['Value'].astype(float)
                energy_shares = energy_shares.pivot(index='Year', columns='Category', values='Value')
                print('energy_share columns (should just be pipeline):', energy_shares.columns)
    
                energy_shares = energy_shares.dropna(axis=1, how='all')
                total_label = level_
                model_ = MultiplicativeLMDI(energy_data, energy_shares, 1985, 2017, total_label)
                eii_output = model_.log_mean_divisia_weights()
                print('eii_output log mean divisia weights: \n', eii_output.head())
    
                # pnnl_data_raw = self.get_pnnl_data(sector)['results']
                # weights_cols = [cat for cat in pnnl_data_raw['Category'].unique() if cat.endswith('eights')]
                # pnnl_weights = pnnl_data_raw[pnnl_data_raw['Category'].isin(weights_cols)]
                print('pnnl_data:\n', pnnl_data)
                pnnl_weights = pnnl_data[(pnnl_data['Data Type'] == 'Log Mean Divisia Weights (normalized)') & (pnnl_data['Nest level'] == level_)]
                print('pnnl_weights:\n', pnnl_weights)
    
                pnnl_weights_ = pnnl_weights.pivot(index='Year', columns='Category', values='Value')
                pnnl_weights_.columns.name = None
                print('pnnl_weights_:\n', pnnl_weights_)
    
                pnnl_weights_ = pnnl_weights_.dropna(axis=1, how='all')
                pnnl_weights_ = pnnl_weights_.rename(columns={col: f'log_mean_weights_{col}' for col in pnnl_weights_.columns})
                print('pnnl_weights_:\n', pnnl_weights_)
    
>               pnnl_weights, eii_output = eii.ensure_same_indices(pnnl_weights, eii_output)

tests\lmdi_test.py:380: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <EnergyIntensityIndicators.transportation.TransportationIndicators object at 0x0000018EB0CDD3C8>
df1 =               Sector   Nest level  ...    Category        Value
96    transportation  All_Freight  ...  Waterborne    ...t  ...        Rail  0.063604094
1823  transportation  All_Freight  ...        Rail  0.060561691

[288 rows x 7 columns]
df2 =       log_mean_weights_  Highway  ...  log_mean_weights_Waterborne
Year                              ...              ...                     0.013383
2017                    0.781068  ...                     0.013052

[48 rows x 5 columns]

    def ensure_same_indices(self, df1, df2):
        """Returns two dataframes with the same indices
        purpose: enable dataframe operations such as multiply and divide between the two dfs
        """
        df1.index = df1.index.astype(int)
        df2.index = df2.index.astype(int)
    
        intersection_ = df1.index.intersection(df2.index)
    
        if len(intersection_) == 0:
>           raise ValueError('DataFrames do not contain any shared years')
E           ValueError: DataFrames do not contain any shared years

EnergyIntensityIndicators\LMDI.py:236: ValueError
---------------------------- Captured stdout call -----------------------------
      Single-Unit Truck  Combination Truck  ...  Oil Pipeline  Natural Gas Pipeline
Year                                        ...                                    
1949                NaN                NaN  ...           NaN                   NaN
1950                NaN                NaN  ...        0.1290            129.437926
1951                NaN                NaN  ...        0.1520            198.463376
1952                NaN                NaN  ...        0.1580            213.630417
1953                NaN                NaN  ...        0.1700            237.453734
1954                NaN                NaN  ...        0.1790            237.764065
1955                NaN                NaN  ...        0.2030            252.848626
1956                NaN                NaN  ...        0.2300            305.147132
1957                NaN                NaN  ...        0.2230            308.511285
1958                NaN                NaN  ...        0.2110            321.899851
1959                NaN                NaN  ...        0.2270            360.177788
1960                NaN                NaN  ...        0.2290            357.834325
1961                NaN                NaN  ...        0.2330            389.312817
1962                NaN                NaN  ...        0.2380            394.353376
1963                NaN           0.000000  ...        0.2530            436.920273
1964                NaN           0.000000  ...        0.2690            449.072670
1965                NaN           0.000000  ...        0.3060            516.040244
1966           0.000000           0.000000  ...        0.3330            551.948943
1967           0.000000           0.000000  ...        0.3610            593.600312
1968           0.000000           0.000000  ...        0.3910            609.284915
1969           0.000000           0.000000  ...        0.4110            650.521822
1970         888.413336        1091.711420  ...        0.4310            778.391688
1971         944.112565        1128.435166  ...        0.4440            800.407995
1972        1084.485544        1206.432138  ...        0.4760            825.806618
1973        1185.178405        1341.001136  ...        0.5070            784.870686
1974        1177.732134        1349.103500  ...        0.5060            720.862148
1975        1213.502200        1363.533043  ...        0.5070            628.350758
1976        1277.369919        1441.540417  ...        0.5150            591.013791
1977        1403.176242        1606.712888  ...        0.5460            574.141017
1978        1547.433559        1796.178344  ...        0.5860            571.750331
...                 ...                ...  ...           ...                   ...
1988        1708.634864        2241.517837  ...        0.6010            661.709355
1989        1726.979704        2317.888922  ...        0.5840            678.304041
1990        1855.637298        2377.456615  ...        0.5840            711.187303
1991        1815.809994        2478.528803  ...        0.5790            648.120811
1992        1830.802864        2539.537151  ...        0.5890            633.467345
1993        1886.653726        2617.972362  ...        0.5930            672.914756
1994        2009.086065        2753.647175  ...        0.5910            738.722238
1995        2051.508898        2921.671724  ...        0.6010            754.860991
1996        2096.128437        2985.451865  ...        0.6192            766.837061
1997        2134.869496        3003.701973  ...        0.6165            809.977210
1998        2173.376382        3294.961809  ...        0.6198            684.953341
1999        2091.696916        3634.380369  ...        0.6177            695.561610
2000        2135.377900        3803.459910  ...        0.5773            692.210553
2001        2159.032784        3781.395383  ...        0.5761            673.621830
2002        2305.789510        3926.050910  ...        0.5862            718.844399
2003        1984.082612        3990.892601  ...        0.5902            637.543801
2004        2001.508403        4061.683287  ...        0.5996            610.268629
2005        2122.595305        4105.253191  ...        0.6075            629.496520
2006        2201.011361        4167.210070  ...        0.5813            629.698079
2007        2234.076682        4232.064839  ...        0.5577            669.741545
2008        2347.738791        4185.093630  ...        0.6057            698.403919
2009        2225.723202        3841.231515  ...        0.5684            722.351746
2010        2067.417903        4098.272212  ...        0.5500            726.609281
2011        1946.689571        3859.170956  ...        0.5500            741.332808
2012        1968.750976        3831.001925  ...        0.5500            787.687127
2013        1985.923540        3943.253529  ...        0.5500            897.920641
2014        2039.604922        3987.444809  ...        0.5500            754.661588
2015        2033.716403        3955.701584  ...        0.5500            730.984303
2016        2100.489469        4047.274900  ...        0.5500            740.198903
2017        2136.286186        4158.061220  ...        0.5500            777.693237

[69 rows x 8 columns]
total_activty_df here:
       Oil Pipeline  Natural Gas Pipeline      Pipeline
Year                                                  
1949           NaN           57425.93309   57425.93309
1950      129000.0           65444.87939  194444.87939
1951      152000.0           75925.35464  227925.35464
1952      158000.0           82233.55629  240233.55629
1953      170000.0           87168.55522  257168.55522
1954      179000.0           93242.01875  272242.01875
1955      203000.0          101601.72830  304601.72830
1956      230000.0          110945.29400  340945.29400
1957      223000.0          118033.03560  341033.03560
1958      211000.0          122802.54040  333802.54040
1959      227000.0          135140.17660  362140.17660
1960      229000.0          144162.48740  373162.48740
1961      233000.0          150274.87030  383274.87030
1962      238000.0          159877.75050  397877.75050
1963      253000.0          168498.23230  421498.23230
1964      269000.0          180606.48990  449606.48990
1965      306000.0          189153.54840  495153.54840
1966      333000.0          206657.99190  539657.99190
1967      361000.0          217599.18200  578599.18200
1968      391000.0          233321.38750  624321.38750
1969      411000.0          251033.85460  662033.85460
1970      431000.0          264069.44300  695069.44300
1971      444000.0          272660.72490  716660.72490
1972      476000.0          276028.09080  752028.09080
1973      507000.0          275271.90530  782271.90530
1974      506000.0          264881.61250  770881.61250
1975      507000.0          243795.97560  750795.97560
1976      515000.0          246648.83650  761648.83650
1977      546000.0          240608.19690  786608.19690
1978      586000.0          242279.23070  828279.23070
...            ...                   ...           ...
1989      584000.0          241872.00050  825872.00050
1990      584000.0          239894.24920  823894.24920
1991      579000.0          247588.51100  826588.51100
1992      589000.0          256449.89590  845449.89590
1993      593000.0          263724.15330  856724.15330
1994      591000.0          269894.90840  860894.90840
1995      601000.0          281674.44100  882674.44100
1996      619200.0          286695.02640  905895.02640
1997      616500.0          288565.62790  905065.62790
1998      619800.0          283776.79530  903576.79530
1999      617700.0          287151.42310  904851.42310
2000      577300.0          299080.24610  876380.24610
2001      576100.0          284572.52510  860672.52510
2002      586200.0          294734.98060  880934.98060
2003      590200.0          285511.39420  875711.39420
2004      599600.0          287762.92800  887362.92800
2005      607500.0          282072.49330  889572.49330
2006      581300.0          277121.09630  858421.09630
2007      557700.0          295045.65520  852745.65520
2008      605700.0          297142.37230  902842.37230
2009      568400.0          291092.27710  859492.27710
2010      550000.0          307231.82100  857231.82100
2011      550000.0          311952.78420  861952.78420
2012      550000.0          325065.26720  875065.26720
2013      550000.0          331001.08970  881001.08970
2014      550000.0          338528.88550  888528.88550
2015      550000.0          346973.72330  896973.72330
2016      550000.0          350068.29260  900068.29260
2017      550000.0          344900.56890  894900.56890
2018      550000.0          382226.62350  932226.62350

[70 rows x 3 columns]
total_activty_df there:
       Oil Pipeline  Natural Gas Pipeline
Year                                    
1949           NaN           57425.93309
1950      129000.0           65444.87939
1951      152000.0           75925.35464
1952      158000.0           82233.55629
1953      170000.0           87168.55522
1954      179000.0           93242.01875
1955      203000.0          101601.72830
1956      230000.0          110945.29400
1957      223000.0          118033.03560
1958      211000.0          122802.54040
1959      227000.0          135140.17660
1960      229000.0          144162.48740
1961      233000.0          150274.87030
1962      238000.0          159877.75050
1963      253000.0          168498.23230
1964      269000.0          180606.48990
1965      306000.0          189153.54840
1966      333000.0          206657.99190
1967      361000.0          217599.18200
1968      391000.0          233321.38750
1969      411000.0          251033.85460
1970      431000.0          264069.44300
1971      444000.0          272660.72490
1972      476000.0          276028.09080
1973      507000.0          275271.90530
1974      506000.0          264881.61250
1975      507000.0          243795.97560
1976      515000.0          246648.83650
1977      546000.0          240608.19690
1978      586000.0          242279.23070
...            ...                   ...
1989      584000.0          241872.00050
1990      584000.0          239894.24920
1991      579000.0          247588.51100
1992      589000.0          256449.89590
1993      593000.0          263724.15330
1994      591000.0          269894.90840
1995      601000.0          281674.44100
1996      619200.0          286695.02640
1997      616500.0          288565.62790
1998      619800.0          283776.79530
1999      617700.0          287151.42310
2000      577300.0          299080.24610
2001      576100.0          284572.52510
2002      586200.0          294734.98060
2003      590200.0          285511.39420
2004      599600.0          287762.92800
2005      607500.0          282072.49330
2006      581300.0          277121.09630
2007      557700.0          295045.65520
2008      605700.0          297142.37230
2009      568400.0          291092.27710
2010      550000.0          307231.82100
2011      550000.0          311952.78420
2012      550000.0          325065.26720
2013      550000.0          331001.08970
2014      550000.0          338528.88550
2015      550000.0          346973.72330
2016      550000.0          350068.29260
2017      550000.0          344900.56890
2018      550000.0          382226.62350

[70 rows x 2 columns]
total_activty_df: 
       Oil Pipeline  Natural Gas Pipeline      Pipeline
Year                                                  
1949           NaN           57425.93309   57425.93309
1950      129000.0           65444.87939  194444.87939
1951      152000.0           75925.35464  227925.35464
1952      158000.0           82233.55629  240233.55629
1953      170000.0           87168.55522  257168.55522
1954      179000.0           93242.01875  272242.01875
1955      203000.0          101601.72830  304601.72830
1956      230000.0          110945.29400  340945.29400
1957      223000.0          118033.03560  341033.03560
1958      211000.0          122802.54040  333802.54040
1959      227000.0          135140.17660  362140.17660
1960      229000.0          144162.48740  373162.48740
1961      233000.0          150274.87030  383274.87030
1962      238000.0          159877.75050  397877.75050
1963      253000.0          168498.23230  421498.23230
1964      269000.0          180606.48990  449606.48990
1965      306000.0          189153.54840  495153.54840
1966      333000.0          206657.99190  539657.99190
1967      361000.0          217599.18200  578599.18200
1968      391000.0          233321.38750  624321.38750
1969      411000.0          251033.85460  662033.85460
1970      431000.0          264069.44300  695069.44300
1971      444000.0          272660.72490  716660.72490
1972      476000.0          276028.09080  752028.09080
1973      507000.0          275271.90530  782271.90530
1974      506000.0          264881.61250  770881.61250
1975      507000.0          243795.97560  750795.97560
1976      515000.0          246648.83650  761648.83650
1977      546000.0          240608.19690  786608.19690
1978      586000.0          242279.23070  828279.23070
...            ...                   ...           ...
1989      584000.0          241872.00050  825872.00050
1990      584000.0          239894.24920  823894.24920
1991      579000.0          247588.51100  826588.51100
1992      589000.0          256449.89590  845449.89590
1993      593000.0          263724.15330  856724.15330
1994      591000.0          269894.90840  860894.90840
1995      601000.0          281674.44100  882674.44100
1996      619200.0          286695.02640  905895.02640
1997      616500.0          288565.62790  905065.62790
1998      619800.0          283776.79530  903576.79530
1999      617700.0          287151.42310  904851.42310
2000      577300.0          299080.24610  876380.24610
2001      576100.0          284572.52510  860672.52510
2002      586200.0          294734.98060  880934.98060
2003      590200.0          285511.39420  875711.39420
2004      599600.0          287762.92800  887362.92800
2005      607500.0          282072.49330  889572.49330
2006      581300.0          277121.09630  858421.09630
2007      557700.0          295045.65520  852745.65520
2008      605700.0          297142.37230  902842.37230
2009      568400.0          291092.27710  859492.27710
2010      550000.0          307231.82100  857231.82100
2011      550000.0          311952.78420  861952.78420
2012      550000.0          325065.26720  875065.26720
2013      550000.0          331001.08970  881001.08970
2014      550000.0          338528.88550  888528.88550
2015      550000.0          346973.72330  896973.72330
2016      550000.0          350068.29260  900068.29260
2017      550000.0          344900.56890  894900.56890
2018      550000.0          382226.62350  932226.62350

[70 rows x 3 columns]
level1_name Pipeline
pnnl_data_raw['Nest level']: ['Buses' 'Cars and SWB Vehicles' 'Freight Total' 'Freight Trucks'
 'transportation' nan 'Light Trucks and LWB' 'Passenger Air'
 'Passenger Highway' 'Passenger-Rail' 'Passenger' 'Personal Vehicles'
 'Pipelines' 'Urban Rail']
energy_share columns (should just be pipeline): Index(['  Highway', 'Air', 'Pipeline', 'Rail', 'Total', 'Waterborne'], dtype='object', name='Category')
log_mean_divisia_weights energy shares: Category    Highway       Air  Pipeline      Rail  Waterborne
Year                                                         
1970       0.543271  0.041197  0.213561  0.144897    0.057075
1971       0.547938  0.046097  0.211611  0.140183    0.054171
1972       0.565031  0.043654  0.203677  0.136732    0.050906
1973       0.591264  0.043630  0.183703  0.135071    0.046332
1974       0.600527  0.043811  0.171320  0.137635    0.046707
1975       0.629994  0.043790  0.153610  0.126694    0.045912
1976       0.639934  0.048032  0.139103  0.127170    0.045761
1977       0.665141  0.042788  0.126877  0.122145    0.043049
1978       0.679913  0.037747  0.116264  0.111914    0.054162
1979       0.676153  0.034814  0.126781  0.110548    0.051704
1980       0.669837  0.034514  0.132732  0.106471    0.056446
1981       0.674291  0.036285  0.133038  0.100592    0.055794
1982       0.695646  0.034918  0.127562  0.087470    0.054404
1983       0.714715  0.036261  0.105658  0.087044    0.056322
1984       0.709187  0.039352  0.109487  0.090279    0.051695
1985       0.719669  0.037775  0.105612  0.084822    0.052122
1986       0.723722  0.044946  0.100466  0.081002    0.049864
1987       0.718356  0.049246  0.103770  0.079791    0.048838
1988       0.704638  0.052360  0.118037  0.078735    0.046230
1989       0.706745  0.056331  0.118518  0.077328    0.041078
1990       0.712124  0.055090  0.119641  0.073126    0.040019
1991       0.729651  0.050544  0.110122  0.068956    0.040728
1992       0.730539  0.053452  0.105889  0.070065    0.040055
1993       0.729840  0.055772  0.109026  0.069933    0.035428
1994       0.724699  0.058076  0.112404  0.070827    0.033993
1995       0.727321  0.059164  0.110397  0.071057    0.032060
1996       0.729124  0.059702  0.110029  0.071664    0.029480
1997       0.724319  0.064543  0.114172  0.070441    0.026524
1998       0.749883  0.063736  0.093929  0.068834    0.023619
1999       0.759826  0.055726  0.092298  0.069000    0.023150
2000       0.761062  0.061763  0.088707  0.066123    0.022345
2001       0.767569  0.058220  0.087039  0.066848    0.020323
2002       0.771206  0.056280  0.088959  0.064391    0.019164
2003       0.769511  0.060028  0.082109  0.068758    0.019594
2004       0.768076  0.063927  0.077308  0.071726    0.018964
2005       0.770059  0.063829  0.077836  0.070656    0.017620
2006       0.772960  0.063639  0.076431  0.070950    0.016020
2007       0.775233  0.061580  0.080296  0.067969    0.014922
2008       0.781776  0.054031  0.083577  0.064918    0.015697
2009       0.786074  0.048557  0.093593  0.057867    0.013909
2010       0.779806  0.052782  0.091898  0.061731    0.013783
2011       0.765071  0.055526  0.097690  0.067818    0.013895
2012       0.764298  0.052276  0.103802  0.066423    0.013201
2013       0.757664  0.047945  0.114741  0.065801    0.013848
2014       0.772215  0.048006  0.096691  0.069255    0.013833
2015       0.775768  0.048997  0.094679  0.066883    0.013673
2016       0.783371  0.048789  0.094319  0.060426    0.013095
2017       0.778744  0.051337  0.096217  0.060695    0.013007
log_mean_divisia_weights col:   Highway
energy shares with shift:
 Category    Highway       Air  Pipeline      Rail  Waterborne    Highway_shift
Year                                                                          
1970       0.543271  0.041197  0.213561  0.144897    0.057075         0.000000
1971       0.547938  0.046097  0.211611  0.140183    0.054171         0.543271
1972       0.565031  0.043654  0.203677  0.136732    0.050906         0.547938
1973       0.591264  0.043630  0.183703  0.135071    0.046332         0.565031
1974       0.600527  0.043811  0.171320  0.137635    0.046707         0.591264
1975       0.629994  0.043790  0.153610  0.126694    0.045912         0.600527
1976       0.639934  0.048032  0.139103  0.127170    0.045761         0.629994
1977       0.665141  0.042788  0.126877  0.122145    0.043049         0.639934
1978       0.679913  0.037747  0.116264  0.111914    0.054162         0.665141
1979       0.676153  0.034814  0.126781  0.110548    0.051704         0.679913
1980       0.669837  0.034514  0.132732  0.106471    0.056446         0.676153
1981       0.674291  0.036285  0.133038  0.100592    0.055794         0.669837
1982       0.695646  0.034918  0.127562  0.087470    0.054404         0.674291
1983       0.714715  0.036261  0.105658  0.087044    0.056322         0.695646
1984       0.709187  0.039352  0.109487  0.090279    0.051695         0.714715
1985       0.719669  0.037775  0.105612  0.084822    0.052122         0.709187
1986       0.723722  0.044946  0.100466  0.081002    0.049864         0.719669
1987       0.718356  0.049246  0.103770  0.079791    0.048838         0.723722
1988       0.704638  0.052360  0.118037  0.078735    0.046230         0.718356
1989       0.706745  0.056331  0.118518  0.077328    0.041078         0.704638
1990       0.712124  0.055090  0.119641  0.073126    0.040019         0.706745
1991       0.729651  0.050544  0.110122  0.068956    0.040728         0.712124
1992       0.730539  0.053452  0.105889  0.070065    0.040055         0.729651
1993       0.729840  0.055772  0.109026  0.069933    0.035428         0.730539
1994       0.724699  0.058076  0.112404  0.070827    0.033993         0.729840
1995       0.727321  0.059164  0.110397  0.071057    0.032060         0.724699
1996       0.729124  0.059702  0.110029  0.071664    0.029480         0.727321
1997       0.724319  0.064543  0.114172  0.070441    0.026524         0.729124
1998       0.749883  0.063736  0.093929  0.068834    0.023619         0.724319
1999       0.759826  0.055726  0.092298  0.069000    0.023150         0.749883
2000       0.761062  0.061763  0.088707  0.066123    0.022345         0.759826
2001       0.767569  0.058220  0.087039  0.066848    0.020323         0.761062
2002       0.771206  0.056280  0.088959  0.064391    0.019164         0.767569
2003       0.769511  0.060028  0.082109  0.068758    0.019594         0.771206
2004       0.768076  0.063927  0.077308  0.071726    0.018964         0.769511
2005       0.770059  0.063829  0.077836  0.070656    0.017620         0.768076
2006       0.772960  0.063639  0.076431  0.070950    0.016020         0.770059
2007       0.775233  0.061580  0.080296  0.067969    0.014922         0.772960
2008       0.781776  0.054031  0.083577  0.064918    0.015697         0.775233
2009       0.786074  0.048557  0.093593  0.057867    0.013909         0.781776
2010       0.779806  0.052782  0.091898  0.061731    0.013783         0.786074
2011       0.765071  0.055526  0.097690  0.067818    0.013895         0.779806
2012       0.764298  0.052276  0.103802  0.066423    0.013201         0.765071
2013       0.757664  0.047945  0.114741  0.065801    0.013848         0.764298
2014       0.772215  0.048006  0.096691  0.069255    0.013833         0.757664
2015       0.775768  0.048997  0.094679  0.066883    0.013673         0.772215
2016       0.783371  0.048789  0.094319  0.060426    0.013095         0.775768
2017       0.778744  0.051337  0.096217  0.060695    0.013007         0.783371
log_mean_divisia_weights col: Air
energy shares with shift:
 Category    Highway       Air  Pipeline  ...  Waterborne    Highway_shift  Air_shift
Year                                     ...                                        
1970       0.543271  0.041197  0.213561  ...    0.057075         0.000000   0.000000
1971       0.547938  0.046097  0.211611  ...    0.054171         0.543271   0.041197
1972       0.565031  0.043654  0.203677  ...    0.050906         0.547938   0.046097
1973       0.591264  0.043630  0.183703  ...    0.046332         0.565031   0.043654
1974       0.600527  0.043811  0.171320  ...    0.046707         0.591264   0.043630
1975       0.629994  0.043790  0.153610  ...    0.045912         0.600527   0.043811
1976       0.639934  0.048032  0.139103  ...    0.045761         0.629994   0.043790
1977       0.665141  0.042788  0.126877  ...    0.043049         0.639934   0.048032
1978       0.679913  0.037747  0.116264  ...    0.054162         0.665141   0.042788
1979       0.676153  0.034814  0.126781  ...    0.051704         0.679913   0.037747
1980       0.669837  0.034514  0.132732  ...    0.056446         0.676153   0.034814
1981       0.674291  0.036285  0.133038  ...    0.055794         0.669837   0.034514
1982       0.695646  0.034918  0.127562  ...    0.054404         0.674291   0.036285
1983       0.714715  0.036261  0.105658  ...    0.056322         0.695646   0.034918
1984       0.709187  0.039352  0.109487  ...    0.051695         0.714715   0.036261
1985       0.719669  0.037775  0.105612  ...    0.052122         0.709187   0.039352
1986       0.723722  0.044946  0.100466  ...    0.049864         0.719669   0.037775
1987       0.718356  0.049246  0.103770  ...    0.048838         0.723722   0.044946
1988       0.704638  0.052360  0.118037  ...    0.046230         0.718356   0.049246
1989       0.706745  0.056331  0.118518  ...    0.041078         0.704638   0.052360
1990       0.712124  0.055090  0.119641  ...    0.040019         0.706745   0.056331
1991       0.729651  0.050544  0.110122  ...    0.040728         0.712124   0.055090
1992       0.730539  0.053452  0.105889  ...    0.040055         0.729651   0.050544
1993       0.729840  0.055772  0.109026  ...    0.035428         0.730539   0.053452
1994       0.724699  0.058076  0.112404  ...    0.033993         0.729840   0.055772
1995       0.727321  0.059164  0.110397  ...    0.032060         0.724699   0.058076
1996       0.729124  0.059702  0.110029  ...    0.029480         0.727321   0.059164
1997       0.724319  0.064543  0.114172  ...    0.026524         0.729124   0.059702
1998       0.749883  0.063736  0.093929  ...    0.023619         0.724319   0.064543
1999       0.759826  0.055726  0.092298  ...    0.023150         0.749883   0.063736
2000       0.761062  0.061763  0.088707  ...    0.022345         0.759826   0.055726
2001       0.767569  0.058220  0.087039  ...    0.020323         0.761062   0.061763
2002       0.771206  0.056280  0.088959  ...    0.019164         0.767569   0.058220
2003       0.769511  0.060028  0.082109  ...    0.019594         0.771206   0.056280
2004       0.768076  0.063927  0.077308  ...    0.018964         0.769511   0.060028
2005       0.770059  0.063829  0.077836  ...    0.017620         0.768076   0.063927
2006       0.772960  0.063639  0.076431  ...    0.016020         0.770059   0.063829
2007       0.775233  0.061580  0.080296  ...    0.014922         0.772960   0.063639
2008       0.781776  0.054031  0.083577  ...    0.015697         0.775233   0.061580
2009       0.786074  0.048557  0.093593  ...    0.013909         0.781776   0.054031
2010       0.779806  0.052782  0.091898  ...    0.013783         0.786074   0.048557
2011       0.765071  0.055526  0.097690  ...    0.013895         0.779806   0.052782
2012       0.764298  0.052276  0.103802  ...    0.013201         0.765071   0.055526
2013       0.757664  0.047945  0.114741  ...    0.013848         0.764298   0.052276
2014       0.772215  0.048006  0.096691  ...    0.013833         0.757664   0.047945
2015       0.775768  0.048997  0.094679  ...    0.013673         0.772215   0.048006
2016       0.783371  0.048789  0.094319  ...    0.013095         0.775768   0.048997
2017       0.778744  0.051337  0.096217  ...    0.013007         0.783371   0.048789

[48 rows x 7 columns]
log_mean_divisia_weights col: Pipeline
energy shares with shift:
 Category    Highway       Air  ...  Air_shift  Pipeline_shift
Year                           ...                           
1970       0.543271  0.041197  ...   0.000000        0.000000
1971       0.547938  0.046097  ...   0.041197        0.213561
1972       0.565031  0.043654  ...   0.046097        0.211611
1973       0.591264  0.043630  ...   0.043654        0.203677
1974       0.600527  0.043811  ...   0.043630        0.183703
1975       0.629994  0.043790  ...   0.043811        0.171320
1976       0.639934  0.048032  ...   0.043790        0.153610
1977       0.665141  0.042788  ...   0.048032        0.139103
1978       0.679913  0.037747  ...   0.042788        0.126877
1979       0.676153  0.034814  ...   0.037747        0.116264
1980       0.669837  0.034514  ...   0.034814        0.126781
1981       0.674291  0.036285  ...   0.034514        0.132732
1982       0.695646  0.034918  ...   0.036285        0.133038
1983       0.714715  0.036261  ...   0.034918        0.127562
1984       0.709187  0.039352  ...   0.036261        0.105658
1985       0.719669  0.037775  ...   0.039352        0.109487
1986       0.723722  0.044946  ...   0.037775        0.105612
1987       0.718356  0.049246  ...   0.044946        0.100466
1988       0.704638  0.052360  ...   0.049246        0.103770
1989       0.706745  0.056331  ...   0.052360        0.118037
1990       0.712124  0.055090  ...   0.056331        0.118518
1991       0.729651  0.050544  ...   0.055090        0.119641
1992       0.730539  0.053452  ...   0.050544        0.110122
1993       0.729840  0.055772  ...   0.053452        0.105889
1994       0.724699  0.058076  ...   0.055772        0.109026
1995       0.727321  0.059164  ...   0.058076        0.112404
1996       0.729124  0.059702  ...   0.059164        0.110397
1997       0.724319  0.064543  ...   0.059702        0.110029
1998       0.749883  0.063736  ...   0.064543        0.114172
1999       0.759826  0.055726  ...   0.063736        0.093929
2000       0.761062  0.061763  ...   0.055726        0.092298
2001       0.767569  0.058220  ...   0.061763        0.088707
2002       0.771206  0.056280  ...   0.058220        0.087039
2003       0.769511  0.060028  ...   0.056280        0.088959
2004       0.768076  0.063927  ...   0.060028        0.082109
2005       0.770059  0.063829  ...   0.063927        0.077308
2006       0.772960  0.063639  ...   0.063829        0.077836
2007       0.775233  0.061580  ...   0.063639        0.076431
2008       0.781776  0.054031  ...   0.061580        0.080296
2009       0.786074  0.048557  ...   0.054031        0.083577
2010       0.779806  0.052782  ...   0.048557        0.093593
2011       0.765071  0.055526  ...   0.052782        0.091898
2012       0.764298  0.052276  ...   0.055526        0.097690
2013       0.757664  0.047945  ...   0.052276        0.103802
2014       0.772215  0.048006  ...   0.047945        0.114741
2015       0.775768  0.048997  ...   0.048006        0.096691
2016       0.783371  0.048789  ...   0.048997        0.094679
2017       0.778744  0.051337  ...   0.048789        0.094319

[48 rows x 8 columns]
log_mean_divisia_weights col: Rail
energy shares with shift:
 Category    Highway       Air  Pipeline  ...  Air_shift  Pipeline_shift  Rail_shift
Year                                     ...                                       
1970       0.543271  0.041197  0.213561  ...   0.000000        0.000000    0.000000
1971       0.547938  0.046097  0.211611  ...   0.041197        0.213561    0.144897
1972       0.565031  0.043654  0.203677  ...   0.046097        0.211611    0.140183
1973       0.591264  0.043630  0.183703  ...   0.043654        0.203677    0.136732
1974       0.600527  0.043811  0.171320  ...   0.043630        0.183703    0.135071
1975       0.629994  0.043790  0.153610  ...   0.043811        0.171320    0.137635
1976       0.639934  0.048032  0.139103  ...   0.043790        0.153610    0.126694
1977       0.665141  0.042788  0.126877  ...   0.048032        0.139103    0.127170
1978       0.679913  0.037747  0.116264  ...   0.042788        0.126877    0.122145
1979       0.676153  0.034814  0.126781  ...   0.037747        0.116264    0.111914
1980       0.669837  0.034514  0.132732  ...   0.034814        0.126781    0.110548
1981       0.674291  0.036285  0.133038  ...   0.034514        0.132732    0.106471
1982       0.695646  0.034918  0.127562  ...   0.036285        0.133038    0.100592
1983       0.714715  0.036261  0.105658  ...   0.034918        0.127562    0.087470
1984       0.709187  0.039352  0.109487  ...   0.036261        0.105658    0.087044
1985       0.719669  0.037775  0.105612  ...   0.039352        0.109487    0.090279
1986       0.723722  0.044946  0.100466  ...   0.037775        0.105612    0.084822
1987       0.718356  0.049246  0.103770  ...   0.044946        0.100466    0.081002
1988       0.704638  0.052360  0.118037  ...   0.049246        0.103770    0.079791
1989       0.706745  0.056331  0.118518  ...   0.052360        0.118037    0.078735
1990       0.712124  0.055090  0.119641  ...   0.056331        0.118518    0.077328
1991       0.729651  0.050544  0.110122  ...   0.055090        0.119641    0.073126
1992       0.730539  0.053452  0.105889  ...   0.050544        0.110122    0.068956
1993       0.729840  0.055772  0.109026  ...   0.053452        0.105889    0.070065
1994       0.724699  0.058076  0.112404  ...   0.055772        0.109026    0.069933
1995       0.727321  0.059164  0.110397  ...   0.058076        0.112404    0.070827
1996       0.729124  0.059702  0.110029  ...   0.059164        0.110397    0.071057
1997       0.724319  0.064543  0.114172  ...   0.059702        0.110029    0.071664
1998       0.749883  0.063736  0.093929  ...   0.064543        0.114172    0.070441
1999       0.759826  0.055726  0.092298  ...   0.063736        0.093929    0.068834
2000       0.761062  0.061763  0.088707  ...   0.055726        0.092298    0.069000
2001       0.767569  0.058220  0.087039  ...   0.061763        0.088707    0.066123
2002       0.771206  0.056280  0.088959  ...   0.058220        0.087039    0.066848
2003       0.769511  0.060028  0.082109  ...   0.056280        0.088959    0.064391
2004       0.768076  0.063927  0.077308  ...   0.060028        0.082109    0.068758
2005       0.770059  0.063829  0.077836  ...   0.063927        0.077308    0.071726
2006       0.772960  0.063639  0.076431  ...   0.063829        0.077836    0.070656
2007       0.775233  0.061580  0.080296  ...   0.063639        0.076431    0.070950
2008       0.781776  0.054031  0.083577  ...   0.061580        0.080296    0.067969
2009       0.786074  0.048557  0.093593  ...   0.054031        0.083577    0.064918
2010       0.779806  0.052782  0.091898  ...   0.048557        0.093593    0.057867
2011       0.765071  0.055526  0.097690  ...   0.052782        0.091898    0.061731
2012       0.764298  0.052276  0.103802  ...   0.055526        0.097690    0.067818
2013       0.757664  0.047945  0.114741  ...   0.052276        0.103802    0.066423
2014       0.772215  0.048006  0.096691  ...   0.047945        0.114741    0.065801
2015       0.775768  0.048997  0.094679  ...   0.048006        0.096691    0.069255
2016       0.783371  0.048789  0.094319  ...   0.048997        0.094679    0.066883
2017       0.778744  0.051337  0.096217  ...   0.048789        0.094319    0.060426

[48 rows x 9 columns]
log_mean_divisia_weights col: Waterborne
energy shares with shift:
 Category    Highway       Air  ...  Rail_shift  Waterborne_shift
Year                           ...                              
1970       0.543271  0.041197  ...    0.000000          0.000000
1971       0.547938  0.046097  ...    0.144897          0.057075
1972       0.565031  0.043654  ...    0.140183          0.054171
1973       0.591264  0.043630  ...    0.136732          0.050906
1974       0.600527  0.043811  ...    0.135071          0.046332
1975       0.629994  0.043790  ...    0.137635          0.046707
1976       0.639934  0.048032  ...    0.126694          0.045912
1977       0.665141  0.042788  ...    0.127170          0.045761
1978       0.679913  0.037747  ...    0.122145          0.043049
1979       0.676153  0.034814  ...    0.111914          0.054162
1980       0.669837  0.034514  ...    0.110548          0.051704
1981       0.674291  0.036285  ...    0.106471          0.056446
1982       0.695646  0.034918  ...    0.100592          0.055794
1983       0.714715  0.036261  ...    0.087470          0.054404
1984       0.709187  0.039352  ...    0.087044          0.056322
1985       0.719669  0.037775  ...    0.090279          0.051695
1986       0.723722  0.044946  ...    0.084822          0.052122
1987       0.718356  0.049246  ...    0.081002          0.049864
1988       0.704638  0.052360  ...    0.079791          0.048838
1989       0.706745  0.056331  ...    0.078735          0.046230
1990       0.712124  0.055090  ...    0.077328          0.041078
1991       0.729651  0.050544  ...    0.073126          0.040019
1992       0.730539  0.053452  ...    0.068956          0.040728
1993       0.729840  0.055772  ...    0.070065          0.040055
1994       0.724699  0.058076  ...    0.069933          0.035428
1995       0.727321  0.059164  ...    0.070827          0.033993
1996       0.729124  0.059702  ...    0.071057          0.032060
1997       0.724319  0.064543  ...    0.071664          0.029480
1998       0.749883  0.063736  ...    0.070441          0.026524
1999       0.759826  0.055726  ...    0.068834          0.023619
2000       0.761062  0.061763  ...    0.069000          0.023150
2001       0.767569  0.058220  ...    0.066123          0.022345
2002       0.771206  0.056280  ...    0.066848          0.020323
2003       0.769511  0.060028  ...    0.064391          0.019164
2004       0.768076  0.063927  ...    0.068758          0.019594
2005       0.770059  0.063829  ...    0.071726          0.018964
2006       0.772960  0.063639  ...    0.070656          0.017620
2007       0.775233  0.061580  ...    0.070950          0.016020
2008       0.781776  0.054031  ...    0.067969          0.014922
2009       0.786074  0.048557  ...    0.064918          0.015697
2010       0.779806  0.052782  ...    0.057867          0.013909
2011       0.765071  0.055526  ...    0.061731          0.013783
2012       0.764298  0.052276  ...    0.067818          0.013895
2013       0.757664  0.047945  ...    0.066423          0.013201
2014       0.772215  0.048006  ...    0.065801          0.013848
2015       0.775768  0.048997  ...    0.069255          0.013833
2016       0.783371  0.048789  ...    0.066883          0.013673
2017       0.778744  0.051337  ...    0.060426          0.013095

[48 rows x 10 columns]
log mean weights: 
       log_mean_weights_  Highway  ...  log_mean_weights_Waterborne
Year                              ...                             
1970                         NaN  ...                          NaN
1971                    0.545601  ...                     0.055610
1972                    0.556441  ...                     0.052522
1973                    0.578048  ...                     0.048583
1974                    0.595884  ...                     0.046519
1975                    0.615143  ...                     0.046308
1976                    0.634951  ...                     0.045837
1977                    0.652456  ...                     0.044391
1978                    0.672500  ...                     0.048393
1979                    0.678031  ...                     0.052923
1980                    0.672990  ...                     0.054040
1981                    0.672062  ...                     0.056119
1982                    0.684913  ...                     0.055096
1983                    0.705138  ...                     0.055358
1984                    0.711947  ...                     0.053975
1985                    0.714415  ...                     0.051908
1986                    0.721694  ...                     0.050985
1987                    0.721036  ...                     0.049349
1988                    0.711475  ...                     0.047522
1989                    0.705691  ...                     0.043603
1990                    0.709431  ...                     0.040546
1991                    0.720852  ...                     0.040372
1992                    0.730095  ...                     0.040390
1993                    0.730190  ...                     0.037694
1994                    0.727267  ...                     0.034706
1995                    0.726009  ...                     0.033017
1996                    0.728222  ...                     0.030752
1997                    0.726719  ...                     0.027976
1998                    0.737027  ...                     0.025043
1999                    0.754843  ...                     0.023384
2000                    0.760444  ...                     0.022745
2001                    0.764311  ...                     0.021318
2002                    0.769387  ...                     0.019738
2003                    0.770358  ...                     0.019378
2004                    0.768793  ...                     0.019277
2005                    0.769067  ...                     0.018284
2006                    0.771509  ...                     0.016807
2007                    0.774096  ...                     0.015464
2008                    0.778500  ...                     0.015306
2009                    0.783923  ...                     0.014785
2010                    0.782935  ...                     0.013846
2011                    0.772415  ...                     0.013839
2012                    0.764685  ...                     0.013545
2013                    0.760976  ...                     0.013522
2014                    0.764916  ...                     0.013840
2015                    0.773990  ...                     0.013753
2016                    0.779563  ...                     0.013382
2017                    0.781055  ...                     0.013051

[48 rows x 5 columns]
sum_log_mean_shares:
 Year
1970    0.000000
1971    0.999924
1972    0.999896
1973    0.999691
1974    0.999912
1975    0.999645
1976    0.999834
1977    0.999744
1978    0.999556
1979    0.999892
1980    0.999925
1981    0.999962
1982    0.999765
1983    0.999603
1984    0.999921
1985    0.999942
1986    0.999850
1987    0.999952
1988    0.999796
1989    0.999922
1990    0.999972
1991    0.999845
1992    0.999970
1993    0.999937
1994    0.999975
1995    0.999985
1996    0.999981
1997    0.999925
1998    0.999565
1999    0.999896
2000    0.999924
2001    0.999959
2002    0.999976
2003    0.999909
2004    0.999943
2005    0.999990
2006    0.999984
2007    0.999961
2008    0.999887
2009    0.999769
2010    0.999943
2011    0.999888
2012    0.999947
2013    0.999870
2014    0.999705
2015    0.999986
2016    0.999937
2017    0.999984
dtype: float64
eii_output log mean divisia weights: 
       log_mean_weights_  Highway  ...  log_mean_weights_Waterborne
Year                              ...                             
1970                         NaN  ...                          NaN
1971                    0.545642  ...                     0.055615
1972                    0.556499  ...                     0.052527
1973                    0.578227  ...                     0.048598
1974                    0.595936  ...                     0.046523

[5 rows x 5 columns]
pnnl_data:
               Sector      Nest level  ...     Category         Value
0     transportation     All_Freight  ...   Waterborne   0.057074699
1     transportation     All_Freight  ...   Waterborne   0.054171104
2     transportation     All_Freight  ...   Waterborne   0.050906394
3     transportation     All_Freight  ...   Waterborne   0.046332009
4     transportation     All_Freight  ...   Waterborne   0.046706916
5     transportation     All_Freight  ...   Waterborne   0.045912165
6     transportation     All_Freight  ...   Waterborne    0.04576114
7     transportation     All_Freight  ...   Waterborne   0.043049464
8     transportation     All_Freight  ...   Waterborne   0.054161931
9     transportation     All_Freight  ...   Waterborne   0.051703831
10    transportation     All_Freight  ...   Waterborne   0.056446295
11    transportation     All_Freight  ...   Waterborne   0.055793935
12    transportation     All_Freight  ...   Waterborne   0.054403968
13    transportation     All_Freight  ...   Waterborne   0.056322164
14    transportation     All_Freight  ...   Waterborne   0.051694808
15    transportation     All_Freight  ...   Waterborne   0.052121891
16    transportation     All_Freight  ...   Waterborne   0.049863963
17    transportation     All_Freight  ...   Waterborne   0.048837738
18    transportation     All_Freight  ...   Waterborne   0.046229696
19    transportation     All_Freight  ...   Waterborne   0.041077969
20    transportation     All_Freight  ...   Waterborne   0.040018546
21    transportation     All_Freight  ...   Waterborne   0.040727652
22    transportation     All_Freight  ...   Waterborne   0.040054831
23    transportation     All_Freight  ...   Waterborne   0.035428194
24    transportation     All_Freight  ...   Waterborne   0.033993216
25    transportation     All_Freight  ...   Waterborne   0.032060338
26    transportation     All_Freight  ...   Waterborne   0.029480356
27    transportation     All_Freight  ...   Waterborne    0.02652409
28    transportation     All_Freight  ...   Waterborne   0.023618964
29    transportation     All_Freight  ...   Waterborne   0.023149975
...              ...             ...  ...          ...           ...
3858  transportation  transportation  ...  All Freight    0.01077928
3859  transportation  transportation  ...  All Freight   0.033807234
3860  transportation  transportation  ...  All Freight  -0.001508237
3861  transportation  transportation  ...  All Freight   0.003298914
3862  transportation  transportation  ...  All Freight   0.003747888
3863  transportation  transportation  ...  All Freight   0.031420366
3864  transportation  transportation  ...  All Freight   0.007104106
3865  transportation  transportation  ...  All Freight  -0.004092493
3866  transportation  transportation  ...  All Freight   0.011937279
3867  transportation  transportation  ...  All Freight   0.036064285
3868  transportation  transportation  ...  All Freight   0.009676687
3869  transportation  transportation  ...  All Freight  -0.001502865
3870  transportation  transportation  ...  All Freight   0.008706753
3871  transportation  transportation  ...  All Freight   0.002712335
3872  transportation  transportation  ...  All Freight   0.018443159
3873  transportation  transportation  ...  All Freight   0.000875099
3874  transportation  transportation  ...  All Freight  -0.011755564
3875  transportation  transportation  ...  All Freight   0.003809132
3876  transportation  transportation  ...  All Freight  -0.006486742
3877  transportation  transportation  ...  All Freight   0.008920244
3878  transportation  transportation  ...  All Freight   0.009910363
3879  transportation  transportation  ...  All Freight   0.024969595
3880  transportation  transportation  ...  All Freight  -0.038435288
3881  transportation  transportation  ...  All Freight  -0.033613607
3882  transportation  transportation  ...  All Freight   0.011738708
3883  transportation  transportation  ...  All Freight    0.00311203
3884  transportation  transportation  ...  All Freight  -0.022845608
3885  transportation  transportation  ...  All Freight   0.027468237
3886  transportation  transportation  ...  All Freight   0.049156787
3887  transportation  transportation  ...  All Freight  -0.006357992

[3888 rows x 7 columns]
pnnl_weights:
               Sector   Nest level  ...    Category        Value
96    transportation  All_Freight  ...  Waterborne          NaN
97    transportation  All_Freight  ...  Waterborne  0.055614512
98    transportation  All_Freight  ...  Waterborne  0.052527312
99    transportation  All_Freight  ...  Waterborne   0.04859831
100   transportation  All_Freight  ...  Waterborne   0.04652332
101   transportation  All_Freight  ...  Waterborne  0.046324862
102   transportation  All_Freight  ...  Waterborne  0.045844209
103   transportation  All_Freight  ...  Waterborne   0.04440287
104   transportation  All_Freight  ...  Waterborne  0.048414733
105   transportation  All_Freight  ...  Waterborne  0.052929101
106   transportation  All_Freight  ...  Waterborne  0.054044457
107   transportation  All_Freight  ...  Waterborne  0.056121635
108   transportation  All_Freight  ...  Waterborne  0.055108967
109   transportation  All_Freight  ...  Waterborne  0.055379489
110   transportation  All_Freight  ...  Waterborne  0.053979691
111   transportation  All_Freight  ...  Waterborne  0.051911092
112   transportation  All_Freight  ...  Waterborne   0.05099225
113   transportation  All_Freight  ...  Waterborne  0.049351454
114   transportation  All_Freight  ...  Waterborne  0.047531494
115   transportation  All_Freight  ...  Waterborne  0.043606509
116   transportation  All_Freight  ...  Waterborne  0.040547104
117   transportation  All_Freight  ...  Waterborne  0.040378334
118   transportation  All_Freight  ...  Waterborne  0.040391515
119   transportation  All_Freight  ...  Waterborne  0.037696585
120   transportation  All_Freight  ...  Waterborne  0.034706638
121   transportation  All_Freight  ...  Waterborne  0.033017843
122   transportation  All_Freight  ...  Waterborne  0.030752907
123   transportation  All_Freight  ...  Waterborne  0.027978283
124   transportation  All_Freight  ...  Waterborne  0.025054347
125   transportation  All_Freight  ...  Waterborne  0.023386111
...              ...          ...  ...         ...          ...
1794  transportation  All_Freight  ...        Rail  0.079277548
1795  transportation  All_Freight  ...        Rail  0.078035196
1796  transportation  All_Freight  ...        Rail  0.075209653
1797  transportation  All_Freight  ...        Rail   0.07103153
1798  transportation  All_Freight  ...        Rail  0.069510747
1799  transportation  All_Freight  ...        Rail  0.070003497
1800  transportation  All_Freight  ...        Rail  0.070381179
1801  transportation  All_Freight  ...        Rail  0.070943231
1802  transportation  All_Freight  ...        Rail  0.071361697
1803  transportation  All_Freight  ...        Rail  0.071056403
1804  transportation  All_Freight  ...        Rail  0.069664944
1805  transportation  All_Freight  ...        Rail  0.068924078
1806  transportation  All_Freight  ...        Rail  0.067556211
1807  transportation  All_Freight  ...        Rail  0.066487145
1808  transportation  All_Freight  ...        Rail  0.065613071
1809  transportation  All_Freight  ...        Rail  0.066556778
1810  transportation  All_Freight  ...        Rail    0.0702355
1811  transportation  All_Freight  ...        Rail   0.07119017
1812  transportation  All_Freight  ...        Rail   0.07080393
1813  transportation  All_Freight  ...        Rail  0.069451437
1814  transportation  All_Freight  ...        Rail   0.06643948
1815  transportation  All_Freight  ...        Rail  0.061339409
1816  transportation  All_Freight  ...        Rail  0.059781698
1817  transportation  All_Freight  ...        Rail  0.064733847
1818  transportation  All_Freight  ...        Rail  0.067121354
1819  transportation  All_Freight  ...        Rail  0.066120245
1820  transportation  All_Freight  ...        Rail  0.067533525
1821  transportation  All_Freight  ...        Rail  0.068063249
1822  transportation  All_Freight  ...        Rail  0.063604094
1823  transportation  All_Freight  ...        Rail  0.060561691

[288 rows x 7 columns]
pnnl_weights_:
           Highway          Air     Pipeline         Rail Total   Waterborne
Year                                                                       
1970          NaN          NaN          NaN          NaN   NaN          NaN
1971  0.545642404   0.04360446  0.212600641  0.142537983   NaN  0.055614512
1972  0.556498501  0.044868856  0.207640099  0.138465233   NaN  0.052527312
1973  0.578226793  0.043655105  0.193577595  0.135942197   NaN   0.04859831
1974  0.595936315  0.043724376  0.177454969   0.13636102   NaN   0.04652332
1975  0.615361582  0.043816474  0.162361406  0.132135675   NaN  0.046324862
1976  0.635056143  0.045886032  0.146260815  0.126952802   NaN  0.045844209
1977  0.652623253  0.045371068  0.132930334  0.124672476   NaN   0.04440287
1978  0.672798589  0.040232721  0.121546858  0.117007098   NaN  0.048414733
1979  0.678104704  0.036264581  0.121459796  0.111241818   NaN  0.052929101
1980  0.673040821  0.034666327  0.129743628  0.108504768   NaN  0.054044457
1981  0.672087357   0.03539331  0.132889883  0.103507816   NaN  0.056121635
1982  0.685074077  0.035605211  0.130311224  0.093900521   NaN  0.055108967
1983  0.705417634  0.035599041  0.116312269  0.087291566   NaN  0.055379489
1984   0.71200366  0.037788218  0.107569487  0.088658945   NaN  0.053979691
1985  0.714456816  0.038560409  0.107544128  0.087527554   NaN  0.051911092
1986  0.721802039   0.04126284  0.103033031  0.082909839   NaN   0.05099225
1987  0.721070479  0.047065524  0.102113935  0.080398608   NaN  0.049351454
1988  0.711620192  0.050797562  0.110773204  0.079277548   NaN  0.047531494
1989   0.70574592  0.054325869  0.118286505  0.078035196   NaN  0.043606509
1990  0.709451212  0.055710025  0.119082007  0.075209653   NaN  0.040547104
1991  0.720963792   0.05279247  0.114833873   0.07103153   NaN  0.040378334
1992  0.730116715  0.051985836  0.107995186  0.069510747   NaN  0.040391515
1993   0.73023592  0.054607236  0.107456762  0.070003497   NaN  0.037696585
1994  0.727285274  0.056917674  0.110709236  0.070381179   NaN  0.034706638
1995  0.726020273  0.058619159  0.111399494  0.070943231   NaN  0.033017843
1996  0.728236415  0.059433905  0.110215077  0.071361697   NaN  0.030752907
1997  0.726773517  0.062095728  0.112096068  0.071056403   NaN  0.027978283
1998  0.737347846  0.064166229  0.103766634  0.069664944   NaN  0.025054347
1999  0.754921536  0.059647573  0.093120701  0.068924078   NaN  0.023386111
2000  0.760501982  0.058697504  0.090497457  0.067556211   NaN  0.022746846
2001   0.76434295  0.059976787  0.087874132  0.066487145   NaN  0.021318987
2002  0.769404771  0.057246079   0.08799775  0.065613071   NaN  0.019738328
2003  0.770428384  0.058139011  0.085495768  0.066556778   NaN  0.019380059
2004  0.768837061  0.061960197  0.079688703    0.0702355   NaN  0.019278539
2005  0.769075179  0.063878564  0.077572365   0.07119017   NaN  0.018283723
2006  0.771520965  0.063735233  0.077132646   0.07080393   NaN  0.016807225
2007   0.77412631  0.062606628  0.078350871  0.069451437   NaN  0.015464755
2008  0.778587926  0.057729922  0.081934914   0.06643948   NaN  0.015307758
2009   0.78410402  0.051257154  0.088510842  0.061339409   NaN  0.014788574
2010   0.78298012  0.050643304  0.092747931  0.059781698   NaN  0.013846946
2011   0.77250164  0.054148846  0.094774904  0.064733847   NaN  0.013840763
2012  0.764724843  0.053887512  0.100720361  0.067121354   NaN  0.013545929
2013  0.761075501  0.050085937  0.109194786  0.066120245   NaN  0.013523531
2014  0.765142304  0.047989999  0.105489971  0.067533525   NaN  0.013844201
2015    0.7740006  0.048500367  0.095682908  0.068063249   NaN  0.013752876
2016  0.779612311  0.048895661   0.09450495  0.063604094   NaN  0.013382983
2017  0.781067717  0.050052674  0.095266378  0.060561691   NaN   0.01305154
pnnl_weights_:
      log_mean_weights_  Highway  ... log_mean_weights_Waterborne
Year                             ...                            
1970                        NaN  ...                         NaN
1971                0.545642404  ...                 0.055614512
1972                0.556498501  ...                 0.052527312
1973                0.578226793  ...                  0.04859831
1974                0.595936315  ...                  0.04652332
1975                0.615361582  ...                 0.046324862
1976                0.635056143  ...                 0.045844209
1977                0.652623253  ...                  0.04440287
1978                0.672798589  ...                 0.048414733
1979                0.678104704  ...                 0.052929101
1980                0.673040821  ...                 0.054044457
1981                0.672087357  ...                 0.056121635
1982                0.685074077  ...                 0.055108967
1983                0.705417634  ...                 0.055379489
1984                 0.71200366  ...                 0.053979691
1985                0.714456816  ...                 0.051911092
1986                0.721802039  ...                  0.05099225
1987                0.721070479  ...                 0.049351454
1988                0.711620192  ...                 0.047531494
1989                 0.70574592  ...                 0.043606509
1990                0.709451212  ...                 0.040547104
1991                0.720963792  ...                 0.040378334
1992                0.730116715  ...                 0.040391515
1993                 0.73023592  ...                 0.037696585
1994                0.727285274  ...                 0.034706638
1995                0.726020273  ...                 0.033017843
1996                0.728236415  ...                 0.030752907
1997                0.726773517  ...                 0.027978283
1998                0.737347846  ...                 0.025054347
1999                0.754921536  ...                 0.023386111
2000                0.760501982  ...                 0.022746846
2001                 0.76434295  ...                 0.021318987
2002                0.769404771  ...                 0.019738328
2003                0.770428384  ...                 0.019380059
2004                0.768837061  ...                 0.019278539
2005                0.769075179  ...                 0.018283723
2006                0.771520965  ...                 0.016807225
2007                 0.77412631  ...                 0.015464755
2008                0.778587926  ...                 0.015307758
2009                 0.78410402  ...                 0.014788574
2010                 0.78298012  ...                 0.013846946
2011                 0.77250164  ...                 0.013840763
2012                0.764724843  ...                 0.013545929
2013                0.761075501  ...                 0.013523531
2014                0.765142304  ...                 0.013844201
2015                  0.7740006  ...                 0.013752876
2016                0.779612311  ...                 0.013382983
2017                0.781067717  ...                  0.01305154

[48 rows x 5 columns]
============================== warnings summary ===============================
tests/lmdi_test.py::TestLMDI::test_multiplicative_lmdi_log_mean_divisia_weights[transportation]
  C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators\EnergyIntensityIndicators\LMDI.py:448: SettingWithCopyWarning:
  
  
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy

tests/lmdi_test.py::TestLMDI::test_multiplicative_lmdi_log_mean_divisia_weights[transportation]
  C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators\tests\lmdi_test.py:101: SettingWithCopyWarning:
  
  
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy

-- Docs: https://docs.pytest.org/en/latest/warnings.html
=========================== short test summary info ===========================
FAILED tests/lmdi_test.py::TestLMDI::test_shift - assert False
FAILED tests/lmdi_test.py::TestLMDI::test_normalize_weights - assert False
FAILED tests/lmdi_test.py::TestLMDI::test_multiplicative_lmdi_log_mean_divisia_weights[transportation]
============= 3 failed, 1 passed, 2 warnings in 136.19s (0:02:16) =============
