============================= test session starts =============================
platform win32 -- Python 3.6.5, pytest-5.4.3, py-1.8.0, pluggy-0.12.0
rootdir: C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators
collected 1 item

tests\lmdi_test.py F                                                     [100%]

================================== FAILURES ===================================
______________ TestLMDI.test_prepare_lmdi_inputs[transportation] ______________

self = <lmdi_test.TestLMDI object at 0x00000228C1CA5320>
sector = 'transportation'

    @pytest.mark.parametrize('sector', ['transportation']) # 'residential', 'commercial', 'industrial', 'electricity',
    def test_prepare_lmdi_inputs(self, sector):
        """`LMDI.prepare_lmdi_inputs to test original PNNL data (compiled for #13 ) against
        PNNL results for energy_input_data, energy_shares, and log_ratios
    
        -Test should be parameterized to loop through all sectors.
    
        prepare_lmdi_inputs returns the following:
            log_ratios = {'activity': log_ratio_activity,
                          'structure': log_ratio_structure,
                          'intensity': log_ratio_intensity}
        """
        eii = self.eii_output_factory(sector)
        pnnl_output = self.get_pnnl_data(sector)
        pnnl_output = pnnl_output['components']
    
        eii_data, pnnl = self.input_data(sector)
        print('pnnl:', pnnl)
        for e_, e_dict in pnnl.items():
            activity_data = e_dict['activity']
            print('activity_data.columns:', activity_data.columns)
            energy_data = e_dict['energy']
            print('energy_data.columns:', energy_data.columns)
    
            total_label = activity_data.columns.name
            print('activity_data:', activity_data)
            print('energy_data:', energy_data)
    
            eii_output = eii.prepare_lmdi_inputs(energy_input_data=energy_data, activity_input_data=activity_data,
>                                                total_label=total_label)

tests\lmdi_test.py:233: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
EnergyIntensityIndicators\LMDI.py:636: in prepare_lmdi_inputs
    activity_shares = self.calculate_shares(activty_data, total_label)
EnergyIntensityIndicators\LMDI.py:578: in calculate_shares
    shares = dataset.drop(total_label, axis=1).divide(dataset[total_label].values.reshape(len(dataset[total_label]), 1))
..\..\..\Anaconda3\envs\EIIEnvironment\lib\site-packages\pandas\core\series.py:3829: in drop
    inplace=inplace, errors=errors)
..\..\..\Anaconda3\envs\EIIEnvironment\lib\site-packages\pandas\core\generic.py:3768: in drop
    axis_name = self._get_axis_name(axis)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

cls = <class 'pandas.core.series.Series'>, axis = 1

    @classmethod
    def _get_axis_name(cls, axis):
        axis = cls._AXIS_ALIASES.get(axis, axis)
        if isinstance(axis, string_types):
            if axis in cls._AXIS_NUMBERS:
                return axis
        else:
            try:
                return cls._AXIS_NAMES[axis]
            except KeyError:
                pass
        raise ValueError('No axis named {0} for object type {1}'
>                        .format(axis, type(cls)))
E       ValueError: No axis named 1 for object type <class 'type'>

..\..\..\Anaconda3\envs\EIIEnvironment\lib\site-packages\pandas\core\generic.py:375: ValueError
---------------------------- Captured stdout call -----------------------------
      Single-Unit Truck  Combination Truck  ...  Oil Pipeline  Natural Gas Pipeline
Year                                        ...                                    
1949                NaN                NaN  ...           NaN                   NaN
1950                NaN                NaN  ...           NaN            129.437926
1951                NaN                NaN  ...           NaN            198.463376
1952                NaN                NaN  ...           NaN            213.630417
1953                NaN                NaN  ...           NaN            237.453734
1954                NaN                NaN  ...           NaN            237.764065
1955                NaN                NaN  ...           NaN            252.848626
1956                NaN                NaN  ...           NaN            305.147132
1957                NaN                NaN  ...           NaN            308.511285
1958                NaN                NaN  ...           NaN            321.899851
1959                NaN                NaN  ...           NaN            360.177788
1960                NaN                NaN  ...           NaN            357.834325
1961                NaN                NaN  ...           NaN            389.312817
1962                NaN                NaN  ...           NaN            394.353376
1963                NaN           0.000000  ...           NaN            436.920273
1964                NaN           0.000000  ...           NaN            449.072670
1965                NaN           0.000000  ...           NaN            516.040244
1966           0.000000           0.000000  ...           NaN            551.948943
1967           0.000000           0.000000  ...           NaN            593.600312
1968           0.000000           0.000000  ...           NaN            609.284915
1969           0.000000           0.000000  ...           NaN            650.521822
1970         888.413336        1091.711420  ...           NaN            778.391688
1971         944.112565        1128.435166  ...           NaN            800.407995
1972        1084.485544        1206.432138  ...           NaN            825.806618
1973        1185.178405        1341.001136  ...           NaN            784.870686
1974        1177.732134        1349.103500  ...           NaN            720.862148
1975        1213.502200        1363.533043  ...           NaN            628.350758
1976        1277.369919        1441.540417  ...           NaN            591.013791
1977        1403.176242        1606.712888  ...           NaN            574.141017
1978        1547.433559        1796.178344  ...           NaN            571.750331
...                 ...                ...  ...           ...                   ...
1988        1708.634864        2241.517837  ...           NaN            661.709355
1989        1726.979704        2317.888922  ...           NaN            678.304041
1990        1855.637298        2377.456615  ...           NaN            711.187303
1991        1815.809994        2478.528803  ...           NaN            648.120811
1992        1830.802864        2539.537151  ...           NaN            633.467345
1993        1886.653726        2617.972362  ...           NaN            672.914756
1994        2009.086065        2753.647175  ...           NaN            738.722238
1995        2051.508898        2921.671724  ...           NaN            754.860991
1996        2096.128437        2985.451865  ...           NaN            766.837061
1997        2134.869496        3003.701973  ...           NaN            809.977210
1998        2173.376382        3294.961809  ...           NaN            684.953341
1999        2091.696916        3634.380369  ...           NaN            695.561610
2000        2135.377900        3803.459910  ...           NaN            692.210553
2001        2159.032784        3781.395383  ...           NaN            673.621830
2002        2305.789510        3926.050910  ...           NaN            718.844399
2003        1984.082612        3990.892601  ...           NaN            637.543801
2004        2001.508403        4061.683287  ...           NaN            610.268629
2005        2122.595305        4105.253191  ...           NaN            629.496520
2006        2201.011361        4167.210070  ...           NaN            629.698079
2007        2234.076682        4232.064839  ...           NaN            669.741545
2008        2347.738791        4185.093630  ...           NaN            698.403919
2009        2225.723202        3841.231515  ...           NaN            722.351746
2010        2067.417903        4098.272212  ...           NaN            726.609281
2011        1946.689571        3859.170956  ...           NaN            741.332808
2012        1968.750976        3831.001925  ...           NaN            787.687127
2013        1985.923540        3943.253529  ...           NaN            897.920641
2014        2039.604922        3987.444809  ...           NaN            754.661588
2015        2033.716403        3955.701584  ...           NaN            730.984303
2016        2100.489469        4047.274900  ...           NaN            740.198903
2017        2136.286186        4158.061220  ...           NaN            777.693237

[69 rows x 8 columns]
total_activty_df here:
       Oil Pipeline  Natural Gas Pipeline      Pipeline
Year                                                  
1949           NaN           57425.93309   57425.93309
1950      129000.0           65444.87939  194444.87939
1951      152000.0           75925.35464  227925.35464
1952      158000.0           82233.55629  240233.55629
1953      170000.0           87168.55522  257168.55522
1954      179000.0           93242.01875  272242.01875
1955      203000.0          101601.72830  304601.72830
1956      230000.0          110945.29400  340945.29400
1957      223000.0          118033.03560  341033.03560
1958      211000.0          122802.54040  333802.54040
1959      227000.0          135140.17660  362140.17660
1960      229000.0          144162.48740  373162.48740
1961      233000.0          150274.87030  383274.87030
1962      238000.0          159877.75050  397877.75050
1963      253000.0          168498.23230  421498.23230
1964      269000.0          180606.48990  449606.48990
1965      306000.0          189153.54840  495153.54840
1966      333000.0          206657.99190  539657.99190
1967      361000.0          217599.18200  578599.18200
1968      391000.0          233321.38750  624321.38750
1969      411000.0          251033.85460  662033.85460
1970      431000.0          264069.44300  695069.44300
1971      444000.0          272660.72490  716660.72490
1972      476000.0          276028.09080  752028.09080
1973      507000.0          275271.90530  782271.90530
1974      506000.0          264881.61250  770881.61250
1975      507000.0          243795.97560  750795.97560
1976      515000.0          246648.83650  761648.83650
1977      546000.0          240608.19690  786608.19690
1978      586000.0          242279.23070  828279.23070
...            ...                   ...           ...
1989      584000.0          241872.00050  825872.00050
1990      584000.0          239894.24920  823894.24920
1991      579000.0          247588.51100  826588.51100
1992      589000.0          256449.89590  845449.89590
1993      593000.0          263724.15330  856724.15330
1994      591000.0          269894.90840  860894.90840
1995      601000.0          281674.44100  882674.44100
1996      619200.0          286695.02640  905895.02640
1997      616500.0          288565.62790  905065.62790
1998      619800.0          283776.79530  903576.79530
1999      617700.0          287151.42310  904851.42310
2000      577300.0          299080.24610  876380.24610
2001      576100.0          284572.52510  860672.52510
2002      586200.0          294734.98060  880934.98060
2003      590200.0          285511.39420  875711.39420
2004      599600.0          287762.92800  887362.92800
2005      607500.0          282072.49330  889572.49330
2006      581300.0          277121.09630  858421.09630
2007      557700.0          295045.65520  852745.65520
2008      605700.0          297142.37230  902842.37230
2009      568400.0          291092.27710  859492.27710
2010      550000.0          307231.82100  857231.82100
2011      550000.0          311952.78420  861952.78420
2012      550000.0          325065.26720  875065.26720
2013      550000.0          331001.08970  881001.08970
2014      550000.0          338528.88550  888528.88550
2015      550000.0          346973.72330  896973.72330
2016      550000.0          350068.29260  900068.29260
2017      550000.0          344900.56890  894900.56890
2018      550000.0          382226.62350  932226.62350

[70 rows x 3 columns]
total_activty_df there:
       Oil Pipeline  Natural Gas Pipeline
Year                                    
1949           NaN           57425.93309
1950      129000.0           65444.87939
1951      152000.0           75925.35464
1952      158000.0           82233.55629
1953      170000.0           87168.55522
1954      179000.0           93242.01875
1955      203000.0          101601.72830
1956      230000.0          110945.29400
1957      223000.0          118033.03560
1958      211000.0          122802.54040
1959      227000.0          135140.17660
1960      229000.0          144162.48740
1961      233000.0          150274.87030
1962      238000.0          159877.75050
1963      253000.0          168498.23230
1964      269000.0          180606.48990
1965      306000.0          189153.54840
1966      333000.0          206657.99190
1967      361000.0          217599.18200
1968      391000.0          233321.38750
1969      411000.0          251033.85460
1970      431000.0          264069.44300
1971      444000.0          272660.72490
1972      476000.0          276028.09080
1973      507000.0          275271.90530
1974      506000.0          264881.61250
1975      507000.0          243795.97560
1976      515000.0          246648.83650
1977      546000.0          240608.19690
1978      586000.0          242279.23070
...            ...                   ...
1989      584000.0          241872.00050
1990      584000.0          239894.24920
1991      579000.0          247588.51100
1992      589000.0          256449.89590
1993      593000.0          263724.15330
1994      591000.0          269894.90840
1995      601000.0          281674.44100
1996      619200.0          286695.02640
1997      616500.0          288565.62790
1998      619800.0          283776.79530
1999      617700.0          287151.42310
2000      577300.0          299080.24610
2001      576100.0          284572.52510
2002      586200.0          294734.98060
2003      590200.0          285511.39420
2004      599600.0          287762.92800
2005      607500.0          282072.49330
2006      581300.0          277121.09630
2007      557700.0          295045.65520
2008      605700.0          297142.37230
2009      568400.0          291092.27710
2010      550000.0          307231.82100
2011      550000.0          311952.78420
2012      550000.0          325065.26720
2013      550000.0          331001.08970
2014      550000.0          338528.88550
2015      550000.0          346973.72330
2016      550000.0          350068.29260
2017      550000.0          344900.56890
2018      550000.0          382226.62350

[70 rows x 2 columns]
total_activty_df: 
       Oil Pipeline  Natural Gas Pipeline      Pipeline
Year                                                  
1949           NaN           57425.93309   57425.93309
1950      129000.0           65444.87939  194444.87939
1951      152000.0           75925.35464  227925.35464
1952      158000.0           82233.55629  240233.55629
1953      170000.0           87168.55522  257168.55522
1954      179000.0           93242.01875  272242.01875
1955      203000.0          101601.72830  304601.72830
1956      230000.0          110945.29400  340945.29400
1957      223000.0          118033.03560  341033.03560
1958      211000.0          122802.54040  333802.54040
1959      227000.0          135140.17660  362140.17660
1960      229000.0          144162.48740  373162.48740
1961      233000.0          150274.87030  383274.87030
1962      238000.0          159877.75050  397877.75050
1963      253000.0          168498.23230  421498.23230
1964      269000.0          180606.48990  449606.48990
1965      306000.0          189153.54840  495153.54840
1966      333000.0          206657.99190  539657.99190
1967      361000.0          217599.18200  578599.18200
1968      391000.0          233321.38750  624321.38750
1969      411000.0          251033.85460  662033.85460
1970      431000.0          264069.44300  695069.44300
1971      444000.0          272660.72490  716660.72490
1972      476000.0          276028.09080  752028.09080
1973      507000.0          275271.90530  782271.90530
1974      506000.0          264881.61250  770881.61250
1975      507000.0          243795.97560  750795.97560
1976      515000.0          246648.83650  761648.83650
1977      546000.0          240608.19690  786608.19690
1978      586000.0          242279.23070  828279.23070
...            ...                   ...           ...
1989      584000.0          241872.00050  825872.00050
1990      584000.0          239894.24920  823894.24920
1991      579000.0          247588.51100  826588.51100
1992      589000.0          256449.89590  845449.89590
1993      593000.0          263724.15330  856724.15330
1994      591000.0          269894.90840  860894.90840
1995      601000.0          281674.44100  882674.44100
1996      619200.0          286695.02640  905895.02640
1997      616500.0          288565.62790  905065.62790
1998      619800.0          283776.79530  903576.79530
1999      617700.0          287151.42310  904851.42310
2000      577300.0          299080.24610  876380.24610
2001      576100.0          284572.52510  860672.52510
2002      586200.0          294734.98060  880934.98060
2003      590200.0          285511.39420  875711.39420
2004      599600.0          287762.92800  887362.92800
2005      607500.0          282072.49330  889572.49330
2006      581300.0          277121.09630  858421.09630
2007      557700.0          295045.65520  852745.65520
2008      605700.0          297142.37230  902842.37230
2009      568400.0          291092.27710  859492.27710
2010      550000.0          307231.82100  857231.82100
2011      550000.0          311952.78420  861952.78420
2012      550000.0          325065.26720  875065.26720
2013      550000.0          331001.08970  881001.08970
2014      550000.0          338528.88550  888528.88550
2015      550000.0          346973.72330  896973.72330
2016      550000.0          350068.29260  900068.29260
2017      550000.0          344900.56890  894900.56890
2018      550000.0          382226.62350  932226.62350

[70 rows x 3 columns]
level1_name Pipeline
pnnl_data_raw['Nest level']: ['Buses' 'Cars and SWB Vehicles' 'Freight Total' 'Freight Trucks'
 'transportation' nan 'Light Trucks and LWB' 'Passenger Air'
 'Passenger Highway' 'Passenger-Rail' 'Passenger' 'Personal Vehicles'
 'Pipelines' 'Urban Rail']
pnnl: {'deliv': {'energy': Pipeline Natural Gas Pipeline Oil Pipeline Pipeline
Year                                               
1970                  778.392     4.31e-07  778.392
1971                  800.408     4.44e-07  800.408
1972                  825.807     4.76e-07  825.807
1973                  784.871     5.07e-07  784.871
1974                  720.862     5.06e-07  720.862
1975                  628.351     5.07e-07  628.351
1976                  591.014     5.15e-07  591.014
1977                  574.141     5.46e-07  574.141
1978                   571.75     5.86e-07   571.75
1979                  647.753     6.08e-07  647.753
1980                  684.032     5.88e-07  684.032
1981                  692.335     5.64e-07  692.335
1982                  642.846     5.66e-07  642.846
1983                  528.195     5.56e-07  528.195
1984                  569.921     5.68e-07  569.921
1985                  542.988     5.64e-07  542.988
1986                  522.805     5.78e-07  522.805
1987                  559.591     5.87e-07  559.591
1988                  661.709     6.01e-07  661.709
1989                  678.304     5.84e-07  678.304
1990                  711.187     5.84e-07  711.187
1991                  648.121     5.79e-07  648.121
1992                  633.467     5.89e-07  633.467
1993                  672.915     5.93e-07  672.915
1994                  738.722     5.91e-07  738.722
1995                  754.861     6.01e-07  754.861
1996                  766.837     6.19e-07  766.837
1997                  809.977     6.17e-07  809.977
1998                  684.953      6.2e-07  684.953
1999                  695.562     6.18e-07  695.562
2000                  692.211     5.77e-07  692.211
2001                  673.622     5.76e-07  673.622
2002                  718.844     5.86e-07  718.844
2003                  637.544      5.9e-07  637.544
2004                  610.269        6e-07  610.269
2005                  629.497     6.08e-07  629.497
2006                  629.698     5.81e-07  629.698
2007                  669.742     5.58e-07  669.742
2008                  698.404     6.06e-07  698.404
2009                  722.352     5.68e-07  722.352
2010                  726.609      5.5e-07  726.609
2011                  741.333      5.5e-07  741.333
2012                  787.687      5.5e-07  787.687
2013                  897.921      5.5e-07  897.921
2014                  754.662      5.5e-07  754.662
2015                  730.984      5.5e-07  730.984
2016                  740.199      5.5e-07  740.199
2017                  777.693      5.5e-07  777.693, 'activity': Pipeline Natural Gas Pipeline Oil Pipeline Pipeline
Year                                               
1970                   264069        0.431   264070
1971                   272661        0.444   272661
1972                   276028        0.476   276029
1973                   275272        0.507   275272
1974                   264882        0.506   264882
1975                   243796        0.507   243796
1976                   246649        0.515   246649
1977                   240608        0.546   240609
1978                   242279        0.586   242280
1979                   251890        0.608   251890
1980                   252931        0.588   252931
1981                   247623        0.564   247623
1982                   226258        0.566   226258
1983                   213364        0.556   213365
1984                   226947        0.568   226948
1985                   219536        0.564   219537
1986                   205687        0.578   205688
1987                   215803        0.587   215803
1988                   226599        0.601   226599
1989                   241872        0.584   241873
1990                   239894        0.584   239895
1991                   247589        0.579   247589
1992                   256450        0.589   256450
1993                   263724        0.593   263725
1994                   269895        0.591   269895
1995                   281674        0.601   281675
1996                   286695       0.6192   286696
1997                   288566       0.6165   288566
1998                   283777       0.6198   283777
1999                   287151       0.6177   287152
2000                   299080       0.5773   299081
2001                   284573       0.5761   284573
2002                   294735       0.5862   294736
2003                   285511       0.5902   285512
2004                   287763       0.5996   287764
2005                   282072       0.6075   282073
2006                   277121       0.5813   277122
2007                   295046       0.5577   295046
2008                   297142       0.6057   297143
2009                   291092       0.5684   291093
2010                   307232         0.55   307232
2011                   311953         0.55   311953
2012                   325065         0.55   325066
2013                   331001         0.55   331002
2014                   338529         0.55   338529
2015                   346974         0.55   346974
2016                   350068         0.55   350069
2017                   344901         0.55   344901}}
activity_data.columns: Index(['Natural Gas Pipeline', 'Oil Pipeline', 'Pipeline'], dtype='object', name='Pipeline')
energy_data.columns: Index(['Natural Gas Pipeline', 'Oil Pipeline', 'Pipeline'], dtype='object', name='Pipeline')
activity_data: Pipeline Natural Gas Pipeline Oil Pipeline Pipeline
Year                                               
1970                   264069        0.431   264070
1971                   272661        0.444   272661
1972                   276028        0.476   276029
1973                   275272        0.507   275272
1974                   264882        0.506   264882
1975                   243796        0.507   243796
1976                   246649        0.515   246649
1977                   240608        0.546   240609
1978                   242279        0.586   242280
1979                   251890        0.608   251890
1980                   252931        0.588   252931
1981                   247623        0.564   247623
1982                   226258        0.566   226258
1983                   213364        0.556   213365
1984                   226947        0.568   226948
1985                   219536        0.564   219537
1986                   205687        0.578   205688
1987                   215803        0.587   215803
1988                   226599        0.601   226599
1989                   241872        0.584   241873
1990                   239894        0.584   239895
1991                   247589        0.579   247589
1992                   256450        0.589   256450
1993                   263724        0.593   263725
1994                   269895        0.591   269895
1995                   281674        0.601   281675
1996                   286695       0.6192   286696
1997                   288566       0.6165   288566
1998                   283777       0.6198   283777
1999                   287151       0.6177   287152
2000                   299080       0.5773   299081
2001                   284573       0.5761   284573
2002                   294735       0.5862   294736
2003                   285511       0.5902   285512
2004                   287763       0.5996   287764
2005                   282072       0.6075   282073
2006                   277121       0.5813   277122
2007                   295046       0.5577   295046
2008                   297142       0.6057   297143
2009                   291092       0.5684   291093
2010                   307232         0.55   307232
2011                   311953         0.55   311953
2012                   325065         0.55   325066
2013                   331001         0.55   331002
2014                   338529         0.55   338529
2015                   346974         0.55   346974
2016                   350068         0.55   350069
2017                   344901         0.55   344901
energy_data: Pipeline Natural Gas Pipeline Oil Pipeline Pipeline
Year                                               
1970                  778.392     4.31e-07  778.392
1971                  800.408     4.44e-07  800.408
1972                  825.807     4.76e-07  825.807
1973                  784.871     5.07e-07  784.871
1974                  720.862     5.06e-07  720.862
1975                  628.351     5.07e-07  628.351
1976                  591.014     5.15e-07  591.014
1977                  574.141     5.46e-07  574.141
1978                   571.75     5.86e-07   571.75
1979                  647.753     6.08e-07  647.753
1980                  684.032     5.88e-07  684.032
1981                  692.335     5.64e-07  692.335
1982                  642.846     5.66e-07  642.846
1983                  528.195     5.56e-07  528.195
1984                  569.921     5.68e-07  569.921
1985                  542.988     5.64e-07  542.988
1986                  522.805     5.78e-07  522.805
1987                  559.591     5.87e-07  559.591
1988                  661.709     6.01e-07  661.709
1989                  678.304     5.84e-07  678.304
1990                  711.187     5.84e-07  711.187
1991                  648.121     5.79e-07  648.121
1992                  633.467     5.89e-07  633.467
1993                  672.915     5.93e-07  672.915
1994                  738.722     5.91e-07  738.722
1995                  754.861     6.01e-07  754.861
1996                  766.837     6.19e-07  766.837
1997                  809.977     6.17e-07  809.977
1998                  684.953      6.2e-07  684.953
1999                  695.562     6.18e-07  695.562
2000                  692.211     5.77e-07  692.211
2001                  673.622     5.76e-07  673.622
2002                  718.844     5.86e-07  718.844
2003                  637.544      5.9e-07  637.544
2004                  610.269        6e-07  610.269
2005                  629.497     6.08e-07  629.497
2006                  629.698     5.81e-07  629.698
2007                  669.742     5.58e-07  669.742
2008                  698.404     6.06e-07  698.404
2009                  722.352     5.68e-07  722.352
2010                  726.609      5.5e-07  726.609
2011                  741.333      5.5e-07  741.333
2012                  787.687      5.5e-07  787.687
2013                  897.921      5.5e-07  897.921
2014                  754.662      5.5e-07  754.662
2015                  730.984      5.5e-07  730.984
2016                  740.199      5.5e-07  740.199
2017                  777.693      5.5e-07  777.693
total_label: 
 Pipeline
energy_input_data: 
 Pipeline Natural Gas Pipeline Oil Pipeline Pipeline
Year                                               
1970                  778.392     4.31e-07  778.392
1971                  800.408     4.44e-07  800.408
1972                  825.807     4.76e-07  825.807
1973                  784.871     5.07e-07  784.871
1974                  720.862     5.06e-07  720.862
1975                  628.351     5.07e-07  628.351
1976                  591.014     5.15e-07  591.014
1977                  574.141     5.46e-07  574.141
1978                   571.75     5.86e-07   571.75
1979                  647.753     6.08e-07  647.753
1980                  684.032     5.88e-07  684.032
1981                  692.335     5.64e-07  692.335
1982                  642.846     5.66e-07  642.846
1983                  528.195     5.56e-07  528.195
1984                  569.921     5.68e-07  569.921
1985                  542.988     5.64e-07  542.988
1986                  522.805     5.78e-07  522.805
1987                  559.591     5.87e-07  559.591
1988                  661.709     6.01e-07  661.709
1989                  678.304     5.84e-07  678.304
1990                  711.187     5.84e-07  711.187
1991                  648.121     5.79e-07  648.121
1992                  633.467     5.89e-07  633.467
1993                  672.915     5.93e-07  672.915
1994                  738.722     5.91e-07  738.722
1995                  754.861     6.01e-07  754.861
1996                  766.837     6.19e-07  766.837
1997                  809.977     6.17e-07  809.977
1998                  684.953      6.2e-07  684.953
1999                  695.562     6.18e-07  695.562
2000                  692.211     5.77e-07  692.211
2001                  673.622     5.76e-07  673.622
2002                  718.844     5.86e-07  718.844
2003                  637.544      5.9e-07  637.544
2004                  610.269        6e-07  610.269
2005                  629.497     6.08e-07  629.497
2006                  629.698     5.81e-07  629.698
2007                  669.742     5.58e-07  669.742
2008                  698.404     6.06e-07  698.404
2009                  722.352     5.68e-07  722.352
2010                  726.609      5.5e-07  726.609
2011                  741.333      5.5e-07  741.333
2012                  787.687      5.5e-07  787.687
2013                  897.921      5.5e-07  897.921
2014                  754.662      5.5e-07  754.662
2015                  730.984      5.5e-07  730.984
2016                  740.199      5.5e-07  740.199
2017                  777.693      5.5e-07  777.693
activity_input_data: 
 Pipeline Natural Gas Pipeline Oil Pipeline Pipeline
Year                                               
1970                   264069        0.431   264070
1971                   272661        0.444   272661
1972                   276028        0.476   276029
1973                   275272        0.507   275272
1974                   264882        0.506   264882
1975                   243796        0.507   243796
1976                   246649        0.515   246649
1977                   240608        0.546   240609
1978                   242279        0.586   242280
1979                   251890        0.608   251890
1980                   252931        0.588   252931
1981                   247623        0.564   247623
1982                   226258        0.566   226258
1983                   213364        0.556   213365
1984                   226947        0.568   226948
1985                   219536        0.564   219537
1986                   205687        0.578   205688
1987                   215803        0.587   215803
1988                   226599        0.601   226599
1989                   241872        0.584   241873
1990                   239894        0.584   239895
1991                   247589        0.579   247589
1992                   256450        0.589   256450
1993                   263724        0.593   263725
1994                   269895        0.591   269895
1995                   281674        0.601   281675
1996                   286695       0.6192   286696
1997                   288566       0.6165   288566
1998                   283777       0.6198   283777
1999                   287151       0.6177   287152
2000                   299080       0.5773   299081
2001                   284573       0.5761   284573
2002                   294735       0.5862   294736
2003                   285511       0.5902   285512
2004                   287763       0.5996   287764
2005                   282072       0.6075   282073
2006                   277121       0.5813   277122
2007                   295046       0.5577   295046
2008                   297142       0.6057   297143
2009                   291092       0.5684   291093
2010                   307232         0.55   307232
2011                   311953         0.55   311953
2012                   325065         0.55   325066
2013                   331001         0.55   331002
2014                   338529         0.55   338529
2015                   346974         0.55   346974
2016                   350068         0.55   350069
2017                   344901         0.55   344901
============================== warnings summary ===============================
tests/lmdi_test.py::TestLMDI::test_prepare_lmdi_inputs[transportation]
tests/lmdi_test.py::TestLMDI::test_prepare_lmdi_inputs[transportation]
  C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators\tests\lmdi_test.py:100: SettingWithCopyWarning:
  
  
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy

tests/lmdi_test.py::TestLMDI::test_prepare_lmdi_inputs[transportation]
  C:\Users\irabidea\Documents\GitHub\EnergyIntensityIndicators\EnergyIntensityIndicators\LMDI.py:440: SettingWithCopyWarning:
  
  
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy

-- Docs: https://docs.pytest.org/en/latest/warnings.html
=========================== short test summary info ===========================
FAILED tests/lmdi_test.py::TestLMDI::test_prepare_lmdi_inputs[transportation]
================== 1 failed, 3 warnings in 123.20s (0:02:03) ==================
